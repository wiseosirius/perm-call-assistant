<!DOCTYPE html>
<html lang="en" class="transition-colors duration-200">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Pacific Companies - Permanent Recruiting Assistant V4 (Modular)
    </title>
    <!-- 
        V4 MODULAR ARCHITECTURE:
        - Core HTML file
        - Specialty data loaded dynamically from specialties/ folder
        - To add a new specialty: Simply drop a new JSON file in specialties/ folder
    -->
    <script src="/auth.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Configure Tailwind for dark mode
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {},
        },
      };
    </script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      .gradient-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      .dark .gradient-header {
        background: linear-gradient(135deg, #4c51bf 0%, #5a3a8e 100%);
      }
      .pulse-animation {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      .progress-ring {
        transform: rotate(-90deg);
        transform-origin: 50% 50%;
      }
      .checklist-item {
        transition: all 0.2s ease;
      }
      .checklist-item:hover {
        transform: translateX(4px);
      }
      .score-excellent {
        color: #059669;
      }
      .dark .score-excellent {
        color: #10b981;
      }
      .score-good {
        color: #2563eb;
      }
      .dark .score-good {
        color: #3b82f6;
      }
      .score-satisfactory {
        color: #f59e0b;
      }
      .dark .score-satisfactory {
        color: #fbbf24;
      }
      .score-needs-dev {
        color: #dc2626;
      }
      .dark .score-needs-dev {
        color: #ef4444;
      }
      .loading-spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
      }
      .dark .loading-spinner {
        border-color: #374151;
        border-top-color: #667eea;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      /* Dark mode toggle animation */
      .dark-mode-toggle {
        transition: transform 0.3s ease;
      }
      .dark-mode-toggle:hover {
        transform: scale(1.1);
      }
    </style>
  </head>
  <body
    class="bg-gray-100 dark:bg-gray-800 dark:bg-gray-900 text-gray-900 dark:text-gray-100 dark:text-gray-100"
  >
    <div id="app">
      <div class="flex items-center justify-center min-h-screen">
        <div class="text-center">
          <div class="loading-spinner mx-auto mb-4"></div>
          <p class="text-xl text-gray-600 dark:text-gray-400">
            Loading specialties...
          </p>
        </div>
      </div>
    </div>

    <script>
      // ============= SPECIALTY LOADER =============

      // Define which specialty files to load
      const SPECIALTY_FILES = [
        "family-medicine",
        "hematology-oncology",
        "obgyn-general",
        "gastroenterology",
        "neurology",
        "urology",
      ];

      // Global specialty data object (will be populated on load)
      let specialtyData = {};

      // Load all specialty JSON files
      async function loadSpecialties() {
        console.log("Loading specialty data...");
        const loadPromises = SPECIALTY_FILES.map(async (specId) => {
          try {
            const response = await fetch(`specialties/${specId}.json`);
            if (!response.ok) {
              throw new Error(
                `Failed to load ${specId}: ${response.statusText}`
              );
            }
            const data = await response.json();
            specialtyData[specId] = data;
            console.log(`√¢≈ì‚Äú Loaded ${specId}`);
          } catch (error) {
            console.error(`√¢≈ì‚Äî Error loading ${specId}:`, error);
            // Create a minimal placeholder
            specialtyData[specId] = {
              name: specId
                .replace(/-/g, " ")
                .replace(/\b\w/g, (l) => l.toUpperCase()),
              icon: "√¢¬ù‚Äú",
              compensation: { median: "N/A", range: "N/A" },
              painPoints: [],
              motivations: [],
              keyQuestions: {
                opening: [],
                painDiscovery: [],
                clinical: [],
                motivation: [],
                compensation: [],
              },
              commonChallenges: [],
              challengingOpportunities: [],
            };
          }
        });

        await Promise.all(loadPromises);
        console.log("All specialties loaded:", Object.keys(specialtyData));
        return specialtyData;
      }

      // ============= STATE MANAGEMENT =============
      let state = {
        activeTab: "prep",
        activeSpecialty: "family-medicine",
        callType: "warm", // warm or cold
        callMode: null, // null or 'live'
        callTimer: 0,
        isTimerRunning: false,
        questionCounter: { open: 0, closed: 0 },
        checklistProgress: {},
        expandedSections: {}, // Track which checklist sections are expanded
        sequenceViolation: false,
        opportunityPresented: false,
        qualificationComplete: false,
        quickNotes: "",
        activeScriptTab: "opening",
        painDepthLevel: 0, // 0-3 (surface, first-level, deep, very deep)
        darkMode: localStorage.getItem("darkMode") === "true" || false, // Dark mode preference
      };

      // Initialize dark mode on load
      function initializeDarkMode() {
        if (state.darkMode) {
          document.documentElement.classList.add("dark");
        } else {
          document.documentElement.classList.remove("dark");
        }
      }

      // Toggle dark mode
      function toggleDarkMode() {
        state.darkMode = !state.darkMode;
        localStorage.setItem("darkMode", state.darkMode);

        if (state.darkMode) {
          document.documentElement.classList.add("dark");
        } else {
          document.documentElement.classList.remove("dark");
        }

        render();
      }

      let timerInterval = null;
      let scrollPositions = {}; // Store scroll positions
      let textareaValues = {}; // Store textarea values

      // Helper to save scroll positions and textarea values
      function saveScrollPositions() {
        const scrollableElements =
          document.querySelectorAll("[data-scroll-id]");
        scrollableElements.forEach((el) => {
          const id = el.getAttribute("data-scroll-id");
          scrollPositions[id] = el.scrollTop;
        });

        // Save textarea values
        const quickNotes = document.getElementById("quickNotesTextarea");
        if (quickNotes) {
          textareaValues.quickNotes = quickNotes.value;
        }
      }

      // Helper to restore scroll positions and textarea values
      function restoreScrollPositions() {
        // Use setTimeout to ensure DOM is ready
        setTimeout(() => {
          Object.keys(scrollPositions).forEach((id) => {
            const el = document.querySelector(`[data-scroll-id="${id}"]`);
            if (el) {
              el.scrollTop = scrollPositions[id];
            }
          });

          // Restore textarea values
          const quickNotes = document.getElementById("quickNotesTextarea");
          if (quickNotes && textareaValues.quickNotes !== undefined) {
            quickNotes.value = textareaValues.quickNotes;
          }
        }, 0);
      }

      // Lightweight update for timer and score without full re-render
      function updateTimerDisplay() {
        if (!state.callMode) return;

        const timerElement = document.getElementById("timerDisplay");
        if (timerElement) {
          timerElement.textContent = formatTime(state.callTimer);
        }
      }

      // ============= CRITICAL QUALIFICATION AREAS (V3.4) =============

      const qualificationChecklist = [
        {
          id: "pain",
          text: "Pain Discovery (Deep)",
          icon: "üîç",
          points: 15,
          category: "critical",
          order: 1,
          description: "WHY are they looking? Dig 3+ levels deep",
          hasFramework: true
        },
        {
          id: "motivation",
          text: "Motivation & Priorities",
          icon: "üéØ",
          points: 12,
          category: "critical",
          order: 2,
          description: "WHAT do they want in ideal practice?"
        },
        {
          id: "search",
          text: "Search Status & Timeline",
          icon: "üîé",
          points: 8,
          category: "important",
          order: 3,
          description: "HOW committed are they to change?"
        },
        {
          id: "current",
          text: "Current Position",
          icon: "üè•",
          points: 8,
          category: "important",
          order: 4,
          description: "WHERE are they now? Establish baseline"
        },
        {
          id: "experience",
          text: "Clinical Scope & Experience",
          icon: "ü•º",
          points: 8,
          category: "important",
          order: 5,
          description: "WHAT can they do? Capabilities"
        },
        {
          id: "compensation",
          text: "Compensation Discovery",
          icon: "üí∞",
          points: 10,
          category: "critical",
          order: 6,
          description: "Financial expectations and current baseline"
        },
        {
          id: "location",
          text: "Location & Community",
          icon: "üìç",
          points: 8,
          category: "important",
          order: 7,
          description: "WHERE do they want to be? Geography"
        },
        {
          id: "family",
          text: "Family & Personal Factors",
          icon: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
          points: 7,
          category: "important",
          order: 8,
          description: "WHO influences decision? Stakeholders"
        },
        {
          id: "availability",
          text: "Availability & Logistics",
          icon: "üìÖ",
          points: 4,
          category: "standard",
          order: 9,
          description: "WHEN can they start? Timing"
        },
        {
          id: "credentials",
          text: "Credentials & Compliance",
          icon: "‚úÖ",
          points: 6,
          category: "standard",
          order: 10,
          description: "Licensing, board cert, compliance basics"
        }
      ];

      // ============= GENERIC QUALIFICATION QUESTIONS =============
      
      const genericQuestions = {
        current: [
          "Walk me through your current role - practice type, responsibilities, daily structure",
          "What does your current compensation package look like including base, bonuses, and benefits?",
          "Describe your typical work week - hours, call requirements, time off",
          "How would you characterize your current patient volume and case complexity?",
          "How long have you been in this position and what changes have you seen over time?"
        ],
        search: [
          "Where are you in your search process right now?",
          "What other opportunities are you actively exploring?",
          "Talk to me about your timeline - when are you hoping to make a transition?",
          "How committed are you to making a change - what would it take for you to stay put?",
          "Walk me through your decision-making process - who else is involved?",
          "What actions have you taken so far in your search?"
        ],
        location: [
          "What geographic areas are you considering and what's driving those preferences?",
          "Help me understand what matters most about location - schools, lifestyle, family proximity, career opportunities?",
          "How flexible might you be on location if other factors were exceptional?",
          "What do you know about [target regions] and what appeals to you about them?",
          "Are there areas you'd prefer to avoid? What's behind that preference?"
        ],
        family: [
          "Tell me about your family situation and how it factors into this decision",
          "What's most important to your family in a potential move?",
          "How does your spouse's career situation affect your geographic flexibility?",
          "Talk to me about your children if applicable - ages, school stages, special needs or activities",
          "How is your family approaching this potential transition? Are they excited, hesitant, supportive?"
        ],
        availability: [
          "What does your contract situation look like - notice requirements, restrictive covenants, non-competes?",
          "When would you ideally like to start a new position and what flexibility do you have?",
          "Are there any constraints on your availability we should be aware of?",
          "Walk me through your timeline from offer acceptance to start date - what needs to happen?",
          "What upcoming commitments might affect your availability or start date?"
        ],
        credentials: [
          "What's your board certification status and timeline if you're still in the process?",
          "Tell me about your licensing - current states, any restrictions or limitations?",
          "How does your credentialing typically go - any issues or concerns to be aware of?",
          "Walk me through your DEA status and malpractice history",
          "Any visa or work authorization considerations we should discuss?"
        ]
      };

      // Generic follow-up questions for pain point categories
      const painFollowUps = {
        "Administrative Burden": [
          "Walk me through a typical day - what percentage is clinical versus administrative?",
          "How has the administrative burden changed over time in your practice?",
          "What specific EMR or documentation issues are consuming your time?"
        ],
        "Work-Life Balance": [
          "Help me understand your current schedule and how it's affecting you",
          "What would better work-life balance look like for you specifically?",
          "How is this impacting your family and personal life?"
        ],
        "Call Burden": [
          "Tell me about your call schedule - how often are you covering?",
          "How is the call schedule structured and how has it been affecting you?",
          "What support systems exist for after-hours coverage?"
        ],
        "Compensation": [
          "Help me understand what you're seeing in the market that's different from your current package",
          "When you think about competitive compensation, what are you comparing it to?",
          "How does the total package - not just base - compare to your expectations?"
        ],
        "Partnership": [
          "Walk me through your current partnership track and what concerns you about it",
          "What are you looking for in a partnership structure?",
          "How important is true ownership versus income opportunity?"
        ],
        "Default": [
          "Help me understand what's behind that concern...",
          "How has this been affecting you day-to-day?",
          "When did you first start noticing this was a problem?"
        ]
      };

      // ============= HELPER FUNCTIONS =============

      function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, "0")}`;
      }

      function calculateQuestionRatio() {
        const total = state.questionCounter.open + state.questionCounter.closed;
        if (total === 0) return 0;
        return Math.round((state.questionCounter.open / total) * 100);
      }

      function getQuestionQualityStatus() {
        const ratio = calculateQuestionRatio();
        if (ratio >= 80)
          return {
            status: "excellent",
            color: "green",
            message: "√∞≈∏≈Ω¬Ø Excellent!",
          };
        if (ratio >= 70)
          return { status: "good", color: "blue", message: "√∞≈∏‚Äò¬ç Good" };
        if (ratio >= 60)
          return {
            status: "satisfactory",
            color: "yellow",
            message: "√¢≈°¬†√Ø¬∏¬è Fair",
          };
        return {
          status: "needs-improvement",
          color: "red",
          message: "√¢¬ù≈í Needs Work",
        };
      }

      function calculateCallScore() {
        let score = 5; // Base credibility points

        // Add points for checked items
        qualificationChecklist.forEach((item) => {
          if (state.checklistProgress[item.id]) {
            score += item.points;
          }
        });

        // Question quality bonus/penalty
        const ratio = calculateQuestionRatio();
        if (ratio >= 80) score += 5;
        else if (ratio >= 70) score += 3;
        else if (ratio >= 60) score += 1;
        else if (ratio < 50) score -= 5;

        // Sequence violation penalty
        if (state.sequenceViolation) score -= 15;

        // Pain depth bonus
        score += state.painDepthLevel * 2;

        return Math.max(0, Math.min(100, score));
      }

      function getScoreLevel(score) {
        if (score >= 90)
          return { level: "Excellent", class: "score-excellent", emoji: "√∞≈∏≈í≈∏" };
        if (score >= 75)
          return { level: "Good", class: "score-good", emoji: "√∞≈∏‚Äò¬ç" };
        if (score >= 60)
          return {
            level: "Satisfactory",
            class: "score-satisfactory",
            emoji: "√¢≈°¬†√Ø¬∏¬è",
          };
        return {
          level: "Needs Development",
          class: "score-needs-dev",
          emoji: "√∞≈∏‚Äù¬¥",
        };
      }

      // ============= STATE CHANGE FUNCTIONS =============

      function startCall(mode) {
        state.callMode = mode;
        state.callTimer = 0;
        state.isTimerRunning = true;
        state.questionCounter = { open: 0, closed: 0 };
        state.checklistProgress = {};
        state.sequenceViolation = false;
        state.opportunityPresented = false;
        state.qualificationComplete = false;
        state.painDepthLevel = 0;
        state.quickNotes = "";

        timerInterval = setInterval(() => {
          state.callTimer++;
          updateTimerDisplay(); // Use lightweight update instead of full render
        }, 1000);

        render();
      }

      function endCall() {
        // Save quick notes before ending
        const quickNotes = document.getElementById("quickNotesTextarea");
        if (quickNotes) {
          state.quickNotes = quickNotes.value;
        }

        state.callMode = null;
        state.isTimerRunning = false;
        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
        render();
      }

      function toggleTimer() {
        state.isTimerRunning = !state.isTimerRunning;
        if (state.isTimerRunning) {
          timerInterval = setInterval(() => {
            state.callTimer++;
            updateTimerDisplay(); // Use lightweight update
          }, 1000);
        } else {
          clearInterval(timerInterval);
        }
        render(); // Only render once to update the pause/play button
      }

      function toggleChecklistItem(id) {
        state.checklistProgress[id] = !state.checklistProgress[id];

        // Auto-collapse when checked
        if (state.checklistProgress[id]) {
          delete state.expandedSections[id];
        }

        // Check if qualification is complete (all critical and important items checked)
        const criticalComplete = qualificationChecklist
          .filter((i) => i.category === "critical")
          .every((i) => state.checklistProgress[i.id]);
        const importantComplete = qualificationChecklist
          .filter((i) => i.category === "important")
          .every((i) => state.checklistProgress[i.id]);

        state.qualificationComplete = criticalComplete && importantComplete;

        render();
      }

      function toggleExpandSection(id) {
        if (state.expandedSections[id]) {
          delete state.expandedSections[id];
        } else {
          state.expandedSections[id] = true;
        }
        render();
      }

      // Get questions for a checklist section (specialty-specific or generic)
      function getQuestionsForSection(sectionId, specialty) {
        // Sections that use specialty-specific questions
        if (sectionId === 'experience') {
          return specialty.keyQuestions.clinical || [];
        }
        if (sectionId === 'motivation') {
          return specialty.keyQuestions.motivation || [];
        }
        if (sectionId === 'compensation') {
          return specialty.keyQuestions.compensation || [];
        }
        if (sectionId === 'pain') {
          return specialty.keyQuestions.painDiscovery || [];
        }
        
        // Sections that use generic questions
        return genericQuestions[sectionId] || [];
      }

      // Get pain point follow-up questions based on category
      function getPainFollowUps(category) {
        // Match category name to follow-ups (case insensitive, partial match)
        for (const [key, questions] of Object.entries(painFollowUps)) {
          if (category.toLowerCase().includes(key.toLowerCase())) {
            return { category: key, questions };
          }
        }
        return { category: "General", questions: painFollowUps.Default };
      }

      function addQuestion(type) {
        if (type === "open") {
          state.questionCounter.open++;
        } else {
          state.questionCounter.closed++;
        }
        render();
      }

      function markOpportunityPresented() {
        state.opportunityPresented = true;

        // Check for sequence violation
        if (!state.qualificationComplete) {
          state.sequenceViolation = true;
        }

        render();
      }

      function increasePainDepth() {
        if (state.painDepthLevel < 3) {
          state.painDepthLevel++;
          render();
        }
      }

      // ============= RENDER FUNCTIONS =============

      function renderPrep() {
        const currentSpecialty = specialtyData[state.activeSpecialty];

        return `
                <div class="space-y-6">
                    <!-- Ready to Call Section -->
                    <div class="bg-gradient-to-br from-blue-500 via-purple-600 to-pink-500 text-white rounded-2xl p-8 shadow-2xl">
                        <h2 class="text-3xl font-bold mb-3 flex items-center">
                            <span class="mr-3">√∞≈∏≈Ω¬Ø</span>
                            Ready to Make the Call?
                        </h2>
                        <p class="text-lg mb-6 opacity-95">
                            Launch your call with the V3.4 Framework guiding you every step of the way
                        </p>
                        <button
                            onclick="startCall('live')"
                            class="bg-white dark:bg-gray-800 text-purple-600 px-8 py-4 rounded-xl font-bold text-lg hover:bg-purple-50 transition transform hover:scale-105 shadow-xl flex items-center justify-center space-x-3 w-full md:w-auto"
                        >
                            <span class="text-2xl">√∞≈∏‚Äú≈æ</span>
                            <span>Start Live Call Assistant</span>
                        </button>
                    </div>

                    <!-- Call Type Selector -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äú‚Äπ</span>
                            Pre-Call Setup
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold mb-2">Call Type:</label>
                                <select
                                    onchange="state.callType = this.value; render();"
                                    class="w-full border-2 rounded-lg p-3 font-medium bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600"
                                >
                                    <option value="warm" ${
                                      state.callType === "warm"
                                        ? "selected"
                                        : ""
                                    }>Warm Lead (Inbound/Referral)</option>
                                    <option value="cold" ${
                                      state.callType === "cold"
                                        ? "selected"
                                        : ""
                                    }>Cold Call (Outbound)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold mb-2">Specialty:</label>
                                <select
                                    onchange="state.activeSpecialty = this.value; render();"
                                    class="w-full border-2 rounded-lg p-3 font-medium bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600"
                                >
                                    ${Object.entries(specialtyData)
                                      .map(
                                        ([key, spec]) =>
                                          `<option value="${key}" ${
                                            state.activeSpecialty === key
                                              ? "selected"
                                              : ""
                                          }>${spec.icon} ${spec.name}</option>`
                                      )
                                      .join("")}
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- V3.4 Framework Overview -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√¢≈°¬°</span>
                            V3.4 Framework Excellence Standards
                        </h3>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="border-2 border-green-200 bg-green-50 rounded-lg p-4">
                                <div class="text-3xl mb-2">√¢¬ù‚Äú</div>
                                <div class="font-bold text-green-800 mb-1">80/20 Question Rule</div>
                                <div class="text-sm text-green-700">80% open-ended questions to unlock deep discovery</div>
                            </div>
                            <div class="border-2 border-blue-200 bg-blue-50 rounded-lg p-4">
                                <div class="text-3xl mb-2">√∞≈∏≈Ω¬Ø</div>
                                <div class="font-bold text-blue-800 mb-1">Sequence Compliance</div>
                                <div class="text-sm text-blue-700">Complete qualification BEFORE opportunity presentation</div>
                            </div>
                            <div class="border-2 border-purple-200 bg-purple-50 rounded-lg p-4">
                                <div class="text-3xl mb-2">√∞≈∏‚Äù¬ç</div>
                                <div class="font-bold text-purple-800 mb-1">Deep Pain Discovery</div>
                                <div class="text-sm text-purple-700">Ask "why" repeatedly to uncover true motivations</div>
                            </div>
                        </div>
                    </div>

                    <!-- Pre-Call Checklist -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-lg mb-4 flex items-center">
                            <span class="mr-2">√¢≈ì‚Ä¶</span>
                            Pre-Call Checklist
                        </h3>
                        <div class="grid md:grid-cols-2 gap-3">
                            ${[
                              "Bullhorn candidate record open and ready",
                              "MGMA compensation data reviewed for specialty",
                              "Specific job opportunities identified (if applicable)",
                              "Google Maps ready for location discussion",
                              "Notepad ready for quick notes",
                              "Mindset: Curious consultant, not salesperson",
                              "Deep breathing - smile - positive energy!",
                              "Remember: Quality of questions = Quality of placement",
                            ]
                              .map(
                                (item) => `
                                <div class="flex items-start space-x-2 text-sm p-2 bg-gray-50 dark:bg-gray-900 rounded">
                                    <span class="text-green-500 text-lg">√¢≈ì‚Äú</span>
                                    <span>${item}</span>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>

                    <!-- Quick Reference: Call Type Differences -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-lg mb-4">Quick Reference: Opening Approaches</h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="border-l-4 border-green-500 bg-green-50 p-4 rounded">
                                <div class="font-bold text-green-800 mb-2">√¢≈ì‚Ä¶ Warm Lead Opening</div>
                                <p class="text-sm italic text-green-700 mb-2">
                                    "Good morning Dr. [Name], this is [Your Name] with Pacific Companies. I'm calling because you expressed interest in exploring permanent opportunities..."
                                </p>
                                <div class="text-xs text-green-600">
                                    √¢‚Ä†‚Äô Acknowledge their interest √¢‚Ä†‚Äô Ask about current situation
                                </div>
                            </div>
                            <div class="border-l-4 border-blue-500 bg-blue-50 p-4 rounded">
                                <div class="font-bold text-blue-800 mb-2">√∞≈∏‚Äú≈æ Cold Call Opening</div>
                                <p class="text-sm italic text-blue-700 mb-2">
                                    "Good morning Dr. [Name], this is [Your Name] with Pacific Companies, a national physician recruitment firm. I'm reaching out because..."
                                </p>
                                <div class="text-xs text-blue-600">
                                    √¢‚Ä†‚Äô Brief credibility √¢‚Ä†‚Äô Open-ended discovery question
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      function renderLiveCall() {
        const currentSpecialty = specialtyData[state.activeSpecialty];
        const score = calculateCallScore();
        const scoreInfo = getScoreLevel(score);
        const questionStatus = getQuestionQualityStatus();
        const completedCount = Object.values(state.checklistProgress).filter(
          (v) => v
        ).length;
        const totalItems = qualificationChecklist.length;
        const ratio = calculateQuestionRatio();

        return `
                <div class="space-y-4">
                    <!-- Call Header with Real-Time Metrics -->
                    <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl p-5 shadow-2xl">
                        <div class="flex flex-wrap justify-between items-center gap-4">
                            <!-- Timer -->
                            <div class="flex items-center space-x-4">
                                <button
                                    onclick="toggleTimer()"
                                    class="bg-white dark:bg-gray-800 bg-opacity-20 hover:bg-opacity-30 rounded-full p-2 transition"
                                >
                                    <span class="text-2xl">${
                                      state.isTimerRunning ? "√¢¬è¬∏" : "√¢‚Äì¬∂"
                                    }</span>
                                </button>
                                <div>
                                    <div class="text-3xl font-bold" id="timerDisplay">${formatTime(
                                      state.callTimer
                                    )}</div>
                                    <div class="text-sm opacity-90">${
                                      currentSpecialty.name
                                    }</div>
                                </div>
                            </div>

                            <!-- Live Score -->
                            <div class="text-center bg-white dark:bg-gray-800 bg-opacity-20 rounded-lg px-6 py-3">
                                <div class="text-sm opacity-90 mb-1">Call Quality Score</div>
                                <div class="text-3xl font-bold"><span id="scoreDisplay">${score}</span>/100</div>
                                <div class="text-xs opacity-90" id="scoreLevelDisplay">${
                                  scoreInfo.emoji
                                } ${scoreInfo.level}</div>
                            </div>

                            <!-- Question Quality Indicator -->
                            <div class="text-center bg-white dark:bg-gray-800 bg-opacity-20 rounded-lg px-6 py-3">
                                <div class="text-sm opacity-90 mb-1">Question Quality</div>
                                <div class="text-3xl font-bold" id="ratioPercentDisplay">${ratio}%</div>
                                <div class="text-xs" id="ratioDisplay">${
                                  questionStatus.message
                                }</div>
                            </div>

                            <!-- End Call Button -->
                            <button
                                onclick="endCall()"
                                class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-bold transition"
                            >
                                End Call
                            </button>
                        </div>

                        <!-- Sequence Violation Alert -->
                        ${
                          state.sequenceViolation
                            ? `
                            <div class="mt-4 bg-red-500 text-white px-4 py-3 rounded-lg flex items-center space-x-2">
                                <span class="text-2xl">√¢≈°¬†√Ø¬∏¬è</span>
                                <div>
                                    <div class="font-bold">Sequence Violation Detected!</div>
                                    <div class="text-sm">Opportunity presented before complete qualification. This will significantly impact your evaluation score.</div>
                                </div>
                            </div>
                        `
                            : ""
                        }
                    </div>

                    <!-- Main Grid -->
                    <div class="grid lg:grid-cols-5 gap-4">
                        <!-- Left Column: Question Counter & Checklist (2 cols) -->
                        <div class="lg:col-span-2 space-y-4">
                            <!-- Question Quality Tracker -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                                <h3 class="font-bold mb-3 flex items-center justify-between">
                                    <span class="flex items-center">
                                        <span class="mr-2">√¢¬ù‚Äú</span>
                                        Question Tracker
                                    </span>
                                    <span class="text-sm px-3 py-1 rounded-full ${
                                      ratio >= 80
                                        ? "bg-green-100 text-green-800"
                                        : ratio >= 70
                                        ? "bg-blue-100 text-blue-800"
                                        : ratio >= 60
                                        ? "bg-yellow-100 text-yellow-800"
                                        : "bg-red-100 text-red-800"
                                    }">
                                        Target: 80%
                                    </span>
                                </h3>
                                
                                <!-- Question Buttons -->
                                <div class="grid grid-cols-2 gap-3 mb-4">
                                    <button
                                        onclick="addQuestion('open')"
                                        class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg font-bold transition"
                                    >
                                        √¢≈æ‚Ä¢ Open-Ended
                                    </button>
                                    <button
                                        onclick="addQuestion('closed')"
                                        class="bg-red-500 hover:bg-red-600 text-white px-4 py-3 rounded-lg font-bold transition"
                                    >
                                        √¢≈æ‚Ä¢ Closed
                                    </button>
                                </div>

                                <!-- Live Ratio Display -->
                                <div class="space-y-2">
                                    <div class="flex justify-between text-sm mb-1">
                                        <span class="font-semibold">Open: ${
                                          state.questionCounter.open
                                        }</span>
                                        <span class="font-semibold">Closed: ${
                                          state.questionCounter.closed
                                        }</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 overflow-hidden">
                                        <div
                                            id="ratioBar"
                                            class="h-full transition-all duration-300 ${
                                              ratio >= 80
                                                ? "bg-green-500"
                                                : ratio >= 70
                                                ? "bg-blue-500"
                                                : ratio >= 60
                                                ? "bg-yellow-500"
                                                : "bg-red-500"
                                            }"
                                            style="width: ${ratio}%"
                                        ></div>
                                    </div>
                                    <div class="text-center text-lg font-bold ${
                                      ratio >= 80
                                        ? "text-green-600"
                                        : ratio >= 70
                                        ? "text-blue-600"
                                        : ratio >= 60
                                        ? "text-yellow-600"
                                        : "text-red-600"
                                    }">
                                        ${ratio}% Open-Ended
                                    </div>
                                </div>

                                <!-- Quick Conversion Reminder -->
                                <div class="mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
                                    <div class="text-xs font-bold text-blue-900 mb-2">Quick Convert:</div>
                                    <div class="text-xs text-blue-800 space-y-1">
                                        <div>√¢¬ù≈í "Do you..." √¢‚Ä†‚Äô √¢≈ì‚Ä¶ "Tell me about..."</div>
                                        <div>√¢¬ù≈í "Are you..." √¢‚Ä†‚Äô √¢≈ì‚Ä¶ "Help me understand..."</div>
                                        <div>√¢¬ù≈í "Have you..." √¢‚Ä†‚Äô √¢≈ì‚Ä¶ "Walk me through..."</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Pain Discovery Depth Meter -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                                <h3 class="font-bold mb-3 flex items-center justify-between">
                                    <span class="flex items-center">
                                        <span class="mr-2">√∞≈∏‚Äù¬ç</span>
                                        Pain Discovery Depth
                                    </span>
                                </h3>
                                <div class="space-y-2">
                                    ${[
                                      {
                                        level: 0,
                                        label: "Surface",
                                        desc: "Basic facts stated",
                                      },
                                      {
                                        level: 1,
                                        label: "First-Level",
                                        desc: "Initial pain identified",
                                      },
                                      {
                                        level: 2,
                                        label: "Deep",
                                        desc: 'Asked "why" at least once',
                                      },
                                      {
                                        level: 3,
                                        label: "Very Deep",
                                        desc: 'Multiple "why" questions',
                                      },
                                    ]
                                      .map(
                                        (item) => `
                                        <div class="flex items-center space-x-2">
                                            <div class="w-6 h-6 rounded-full ${
                                              state.painDepthLevel >= item.level
                                                ? "bg-purple-500"
                                                : "bg-gray-200 dark:bg-gray-700"
                                            } flex items-center justify-center text-white text-xs font-bold">
                                                ${
                                                  state.painDepthLevel >=
                                                  item.level
                                                    ? "√¢≈ì‚Äú"
                                                    : item.level
                                                }
                                            </div>
                                            <div class="flex-1">
                                                <div class="text-sm font-semibold">${
                                                  item.label
                                                }</div>
                                                <div class="text-xs text-gray-600 dark:text-gray-400">${
                                                  item.desc
                                                }</div>
                                            </div>
                                        </div>
                                    `
                                      )
                                      .join("")}
                                </div>
                                <button
                                    onclick="increasePainDepth()"
                                    class="w-full mt-3 bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg font-bold transition text-sm"
                                >
                                    √¢¬¨‚Ä†√Ø¬∏¬è Asked "Why"
                                </button>
                            </div>

// This is the new expandable qualification checklist rendering
// Replace lines 1064-1131 in index.html

                            <!-- Qualification Tracker (Expandable) -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                                <h3 class="font-bold mb-3 flex items-center justify-between">
                                    <span class="flex items-center">
                                        <span class="mr-2">üìã</span>
                                        Qualification Tracker
                                    </span>
                                    <span class="text-sm">${completedCount}/${totalItems}</span>
                                </h3>
                                <div class="space-y-2 max-h-[600px] overflow-y-auto" data-scroll-id="qualification-checklist">
                                    ${qualificationChecklist
                                      .map(
                                        (item) => {
                                          const isCompleted = state.checklistProgress[item.id];
                                          const isExpanded = state.expandedSections[item.id];
                                          const questions = getQuestionsForSection(item.id, currentSpecialty);
                                          
                                          return `
                                        <div class="rounded-lg border-2 transition-all duration-200 ${
                                          isCompleted
                                            ? "bg-green-50 dark:bg-green-900 dark:bg-opacity-30 border-green-500 dark:border-green-400"
                                            : item.category === "critical"
                                            ? "bg-red-50 dark:bg-red-900 dark:bg-opacity-20 border-red-200 dark:border-red-700"
                                            : "bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700"
                                        }">
                                            <!-- Header (always visible) -->
                                            <div class="p-3 cursor-pointer" onclick="toggleExpandSection('${item.id}')">
                                                <div class="flex items-center justify-between">
                                                    <div class="flex items-center space-x-3 flex-1">
                                                        <!-- Step number -->
                                                        <div class="flex-shrink-0 w-7 h-7 rounded-full ${
                                                          isCompleted
                                                            ? "bg-green-500 text-white"
                                                            : "bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300"
                                                        } flex items-center justify-center text-xs font-bold">
                                                          ${item.order}
                                                        </div>
                                                        
                                                        <!-- Checkbox -->
                                                        <div 
                                                          class="w-6 h-6 rounded border-2 flex items-center justify-center cursor-pointer ${
                                                            isCompleted
                                                              ? "bg-green-500 border-green-500"
                                                              : "border-gray-300 dark:border-gray-600 hover:border-green-400"
                                                          }"
                                                          onclick="event.stopPropagation(); toggleChecklistItem('${item.id}')"
                                                        >
                                                          ${isCompleted ? '<span class="text-white text-sm font-bold">‚úì</span>' : ''}
                                                        </div>
                                                        
                                                        <!-- Icon and text -->
                                                        <div class="flex items-center space-x-2 flex-1">
                                                          <span class="text-lg">${item.icon}</span>
                                                          <div class="flex flex-col">
                                                            <span class="text-sm font-semibold text-gray-900 dark:text-gray-100">${item.text}</span>
                                                            <span class="text-xs text-gray-500 dark:text-gray-400 italic">${item.description}</span>
                                                          </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Right side -->
                                                    <div class="flex items-center space-x-2">
                                                        ${item.category === "critical" 
                                                          ? '<span class="text-xs bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-2 py-1 rounded font-semibold">Critical</span>' 
                                                          : ''
                                                        }
                                                        <span class="text-xs text-gray-500 dark:text-gray-400 font-medium">${item.points}pts</span>
                                                        <svg class="w-5 h-5 text-gray-400 dark:text-gray-500 transition-transform duration-300 ${isExpanded ? 'rotate-180' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Expandable Questions Section -->
                                            ${isExpanded ? `
                                            <div class="border-t border-gray-200 dark:border-gray-700 px-4 pb-4 pt-3">
                                                <!-- Framework Tips for Critical Sections -->
                                                ${item.id === 'pain' ? `
                                                <div class="mb-3 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-30 border border-blue-200 dark:border-blue-700 rounded text-xs text-blue-800 dark:text-blue-200">
                                                  <strong>üí° Critical:</strong> Pain Discovery is worth 15 points. Ask "why" at least 3 times to dig deep. Use variations: "Help me understand..." "Tell me more..." "What's the story behind..."
                                                </div>` : ''}
                                                
                                                ${item.id === 'motivation' ? `
                                                <div class="mb-3 p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-30 border border-purple-200 dark:border-purple-700 rounded text-xs text-purple-800 dark:text-purple-200">
                                                  <strong>üéØ Critical:</strong> Worth 12 points. Go beyond surface preferences - understand what they REALLY want in their ideal practice.
                                                </div>` : ''}
                                                
                                                ${item.id === 'compensation' ? `
                                                <div class="mb-3 p-3 bg-green-50 dark:bg-green-900 dark:bg-green-opacity-30 border border-green-200 dark:border-green-700 rounded text-xs text-green-800 dark:text-green-200">
                                                  <strong>üí∞ Critical:</strong> Worth 10 points. Discover current baseline BEFORE discussing opportunities. Use open-ended questions.
                                                </div>` : ''}
                                                
                                                <!-- Questions List -->
                                                <div class="space-y-2 mb-3">
                                                  ${questions.slice(0, 6).map(q => `
                                                    <div class="flex items-start text-sm">
                                                      <span class="text-blue-500 dark:text-blue-400 mr-2 mt-0.5 flex-shrink-0">‚Ä¢</span>
                                                      <span class="text-gray-700 dark:text-gray-300 italic">"${q}"</span>
                                                    </div>
                                                  `).join('')}
                                                </div>
                                                
                                                <!-- Pain Point Follow-Ups (only for pain section) -->
                                                ${item.id === 'pain' && currentSpecialty.painPoints && currentSpecialty.painPoints.length > 0 ? `
                                                <div class="mt-3 pt-3 border-t border-gray-200 dark:border-gray-700">
                                                  <div class="text-xs font-bold text-gray-700 dark:text-gray-300 mb-2">üìå Common ${currentSpecialty.name} Pain Points - Listen For:</div>
                                                  ${currentSpecialty.painPoints.slice(0, 3).map(category => {
                                                    const followUp = getPainFollowUps(category.category);
                                                    return `
                                                    <div class="mb-3 p-2 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 border border-yellow-200 dark:border-yellow-700 rounded">
                                                      <div class="text-xs font-semibold text-yellow-900 dark:text-yellow-200 mb-1">${category.category}</div>
                                                      <div class="text-xs text-yellow-800 dark:text-yellow-300 space-y-1 mb-2">
                                                        ${category.points.slice(0, 2).map(point => `<div>‚Ä¢ ${point}</div>`).join('')}
                                                      </div>
                                                      <div class="text-xs font-semibold text-yellow-900 dark:text-yellow-200 mb-1">‚Ü≥ Dig deeper:</div>
                                                      <div class="text-xs text-yellow-800 dark:text-yellow-300 space-y-1 pl-3">
                                                        ${followUp.questions.map(q => `<div class="italic">‚Üí "${q}"</div>`).join('')}
                                                      </div>
                                                    </div>
                                                    `;
                                                  }).join('')}
                                                </div>
                                                ` : ''}
                                                
                                                <!-- Link to Pain Framework -->
                                                ${item.hasFramework ? `
                                                <button 
                                                  onclick="event.stopPropagation(); state.activeScriptTab = 'pain'; render();"
                                                  class="mt-2 text-xs bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded transition"
                                                >
                                                  üîç See Full Pain Discovery Framework ‚Üí
                                                </button>
                                                ` : ''}
                                            </div>
                                            ` : ''}
                                        </div>
                                        `;
                                        }
                                      )
                                      .join("")}
                                </div>


                                <!-- Opportunity Presentation Button -->                                </div>

                                <!-- Opportunity Presentation Button -->
                                ${
                                  !state.opportunityPresented
                                    ? `
                                    <button
                                        onclick="markOpportunityPresented()"
                                        class="w-full mt-4 ${
                                          state.qualificationComplete
                                            ? "bg-blue-500 hover:bg-blue-600"
                                            : "bg-red-500 hover:bg-red-600"
                                        } text-white px-4 py-3 rounded-lg font-bold transition"
                                    >
                                        ${
                                          state.qualificationComplete
                                            ? "√¢≈ì‚Ä¶"
                                            : "√¢≈°¬†√Ø¬∏¬è"
                                        } Present Opportunity
                                    </button>
                                `
                                    : `
                                    <div class="mt-4 bg-green-100 border border-green-500 text-green-800 px-4 py-2 rounded-lg text-center font-semibold">
                                        √¢≈ì‚Ä¶ Opportunity Presented
                                    </div>
                                `
                                }
                            </div>

                            <!-- Quick Notes -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4">
                                <h3 class="font-bold mb-2 flex items-center">
                                    <span class="mr-2">√∞≈∏‚Äú¬ù</span>
                                    Quick Notes
                                </h3>
                                <textarea
                                    id="quickNotesTextarea"
                                    placeholder="Key points, red flags, unique qualifications..."
                                    class="w-full border-2 rounded-lg p-3 text-sm h-32 focus:border-blue-500 focus:outline-none"
                                ></textarea>
                                <p class="text-xs text-gray-500 mt-2">
                                    √∞≈∏‚Äô¬æ Transfer to Bullhorn immediately after call
                                </p>
                            </div>
                        </div>

                        <!-- Right Column: Scripts & Guidance (3 cols) -->
                        <div class="lg:col-span-3 space-y-4">
                            <!-- Script Tabs -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                                <div class="flex overflow-x-auto border-b-2">
                                    ${[
                                      {
                                        id: "opening",
                                        label: "Opening",
                                        icon: "√∞≈∏‚Äò‚Äπ",
                                      },
                                      {
                                        id: "pain",
                                        label: "Pain Discovery",
                                        icon: "√∞≈∏‚Äù¬ç",
                                      },
                                      {
                                      {
                                        id: "challenging",
                                        label: "Challenging",
                                        icon: "√∞≈∏‚Äô¬™",
                                      },
                                      {
                                        id: "closing",
                                        label: "Closing & Presentation",
                                        icon: "√∞≈∏≈Ω¬Ø",
                                      },
                                      {
                                        id: "closing",
                                        label: "Closing",
                                        icon: "√∞≈∏¬§¬ù",
                                      },
                                    ]
                                      .map(
                                        (tab) => `
                                        <button
                                            onclick="state.activeScriptTab = '${
                                              tab.id
                                            }'; render();"
                                            class="flex-shrink-0 px-4 py-3 font-bold transition ${
                                              state.activeScriptTab === tab.id
                                                ? "bg-blue-500 text-white border-b-4 border-blue-700"
                                                : "text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:bg-gray-800"
                                            }"
                                        >
                                            <span class="mr-1">${
                                              tab.icon
                                            }</span>
                                            <span class="text-sm">${
                                              tab.label
                                            }</span>
                                        </button>
                                    `
                                      )
                                      .join("")}
                                </div>
                                
                                <div class="p-5 max-h-[600px] overflow-y-auto" data-scroll-id="script-content">
                                    ${renderScriptContent(currentSpecialty)}
                                </div>
                            </div>

                            <!-- Specialty-Specific Intelligence -->
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-5">
                                <h3 class="font-bold text-lg mb-4 flex items-center">
                                    <span class="mr-2">${
                                      currentSpecialty.icon
                                    }</span>
                                    ${currentSpecialty.name} Intelligence
                                </h3>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <div class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-2">√∞≈∏‚Äô¬∞ Compensation Range</div>
                                        <div class="text-lg font-bold text-green-600">${
                                          currentSpecialty.compensation.median
                                        }</div>
                                        <div class="text-xs text-gray-600 dark:text-gray-400">${
                                          currentSpecialty.compensation.range
                                        }</div>
                                    </div>
                                    <div>
                                        <div class="text-sm font-bold text-gray-700 dark:text-gray-300 mb-2">√∞≈∏≈Ω¬Ø Common Motivations</div>
                                        <div class="text-xs space-y-1">
                                            ${currentSpecialty.motivations
                                              .slice(0, 3)
                                              .map((m) => `<div>√¢‚Ç¨¬¢ ${m}</div>`)
                                              .join("")}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      function renderScriptContent(currentSpecialty) {
        const tab = state.activeScriptTab;

        if (tab === "opening") {
          return `
                    <div class="space-y-4">
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                            <div class="font-bold text-blue-900 mb-2 flex items-center">
                                <span class="mr-2">√∞≈∏‚Äò‚Äπ</span>
                                GREETING & PERMISSION
                            </div>
                            <p class="text-sm italic text-blue-800 mb-3">
                                ${
                                  state.callType === "warm"
                                    ? '"Good morning Dr. [Name], this is [Your Name] with Pacific Companies. I\'m calling because you expressed interest in exploring permanent opportunities. How are you today?"'
                                    : '"Good morning Dr. [Name], this is [Your Name] with Pacific Companies, a national physician recruitment firm. How are you today?"'
                                }
                            </p>
                            <div class="text-xs text-blue-700 bg-blue-100 p-2 rounded">
                                <strong>Why this works:</strong> Warm greeting establishes rapport immediately. ${
                                  state.callType === "warm"
                                    ? "Acknowledging their interest shows you're responding to them."
                                    : "Brief introduction provides context without overwhelming."
                                }
                            </div>
                        </div>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-lg">
                            <div class="font-bold text-green-900 mb-2 flex items-center">
                                <span class="mr-2">√∞≈∏≈Ω¬Ø</span>
                                PURPOSE STATEMENT
                            </div>
                            <p class="text-sm italic text-green-800 mb-3">
                                ${
                                  state.callType === "warm"
                                    ? "\"I'd like to understand what you're looking for in your next position and, if appropriate, share some opportunities that might align with your goals. Does that sound good?\""
                                    : "\"I'm reaching out because we're working with several excellent practices in ${currentSpecialty.name} that are actively recruiting. Before I share details, I'd love to understand your current situation - is this a good time to talk for a few minutes?\""
                                }
                            </p>
                            <div class="text-xs text-green-700 bg-green-100 p-2 rounded">
                                <strong>Why this works:</strong> Sets clear expectations and asks permission, making the physician feel in control rather than pressured.
                            </div>
                        </div>

                        <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded-lg">
                            <div class="font-bold text-purple-900 mb-2 flex items-center">
                                <span class="mr-2">√∞≈∏≈°‚Ç¨</span>
                                OPENING DISCOVERY QUESTION
                            </div>
                            <div class="space-y-2 text-sm italic text-purple-800">
                                <p>"Tell me about your current situation - what are you doing now?"</p>
                                <p><strong>OR</strong></p>
                                <p>"What's your current situation and how is it going?"</p>
                            </div>
                            <div class="text-xs text-purple-700 bg-purple-100 p-2 rounded mt-3">
                                <strong>Why this works:</strong> Broad, open-ended question that invites storytelling rather than yes/no responses. Sets tone for consultative conversation.
                            </div>
                        </div>

                        <div class="bg-yellow-50 border border-yellow-500 p-4 rounded-lg">
                            <div class="font-bold text-yellow-900 mb-2">√¢≈°¬†√Ø¬∏¬è What NOT to Say</div>
                            <div class="text-sm text-yellow-800 space-y-1">
                                <div>√¢¬ù≈í "I have the perfect position for you..." (premature)</div>
                                <div>√¢¬ù≈í "Do you have a few minutes?" (invites no)</div>
                                <div>√¢¬ù≈í Long company pitch before asking about them</div>
                                <div>√¢¬ù≈í "Are you open to opportunities?" (closed question)</div>
                            </div>
                        </div>
                    </div>
                `;
        }

        if (tab === "pain") {
          return `
                    <div class="space-y-4">
                        <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-lg">
                            <div class="font-bold text-red-900 mb-3 flex items-center">
                                <span class="mr-2">√∞≈∏‚Äù¬ç</span>
                                DEEP PAIN DISCOVERY FRAMEWORK
                            </div>
                            <div class="space-y-3">
                                <div>
                                    <div class="text-sm font-bold text-red-800 mb-1">Level 1: Surface Discovery</div>
                                    <p class="text-sm italic text-red-700">"What's driving you to explore new opportunities right now?"</p>
                                    <p class="text-sm italic text-red-700">"Tell me about what you're looking to change or improve in your next position."</p>
                                </div>
                                <div class="border-t border-red-200 pt-3">
                                    <div class="text-sm font-bold text-red-800 mb-1">Level 2: Dig Deeper with "Why"</div>
                                    <p class="text-sm italic text-red-700">"Help me understand what's behind that decision..."</p>
                                    <p class="text-sm italic text-red-700">"Tell me more about how [situation] is affecting you..."</p>
                                    <p class="text-sm italic text-red-700">"What's the story behind [pain point]?"</p>
                                </div>
                                <div class="border-t border-red-200 pt-3">
                                    <div class="text-sm font-bold text-red-800 mb-1">Level 3: Emotional Impact</div>
                                    <p class="text-sm italic text-red-700">"How has this been affecting you personally and professionally?"</p>
                                    <p class="text-sm italic text-red-700">"When did you realize things needed to change?"</p>
                                    <p class="text-sm italic text-red-700">"Walk me through what a typical week looks like and where the biggest frustrations are..."</p>
                                </div>
                            </div>
                            <div class="text-xs text-red-700 bg-red-100 p-2 rounded mt-3">
                                <strong>Critical Rule:</strong> Never accept the first answer. Always ask at least 2-3 follow-up "why" questions to uncover true motivations. Surface pain = weak positioning. Deep pain = strong placements.
                            </div>
                        </div>

                        <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded-lg">
                            <div class="font-bold text-purple-900 mb-2">√∞≈∏‚Äô≈Ω Specialty-Specific Pain Discovery</div>
                            ${currentSpecialty.painPoints
                              .slice(0, 2)
                              .map(
                                (category) => `
                                <div class="mb-3">
                                    <div class="text-sm font-bold text-purple-800">${
                                      category.category
                                    }</div>
                                    <div class="text-xs text-purple-700 space-y-1 mt-1">
                                        ${category.points
                                          .slice(0, 3)
                                          .map(
                                            (point) => `<div>√¢‚Ç¨¬¢ ${point}</div>`
                                          )
                                          .join("")}
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                            <div class="font-bold text-blue-900 mb-2">√∞≈∏≈Ω¬Ø Pain Discovery Questions</div>
                            <div class="space-y-2 text-sm text-blue-800">
                                ${currentSpecialty.keyQuestions.painDiscovery
                                  .slice(0, 4)
                                  .map(
                                    (q) =>
                                      `<div class="flex items-start">
                                        <span class="mr-2 mt-1">√¢‚Ç¨¬¢</span>
                                        <span class="italic">"${q}"</span>
                                    </div>`
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <div class="bg-yellow-50 border border-yellow-500 p-4 rounded-lg">
                            <div class="font-bold text-yellow-900 mb-2">√∞≈∏‚Äô¬° Pro Tip: The Curiosity Loop</div>
                            <div class="text-sm text-yellow-800">
                                After EVERY answer the physician gives, pause and ask yourself: "What's behind this?" Then ask them. This simple habit will transform your discovery depth and differentiate you from every other recruiter.
                            </div>
                        </div>
                    </div>
                `;
        }

        if (tab === "challenging") {
          return `
                    <div class="space-y-4">
                        <div class="bg-indigo-50 border-l-4 border-indigo-500 p-4 rounded-lg">
                            <div class="font-bold text-indigo-900 mb-3 flex items-center">
                                <span class="mr-2">√∞≈∏‚Äô¬™</span>
                                PROFESSIONAL CHALLENGING FRAMEWORK
                            </div>
                            <div class="text-sm text-indigo-800 mb-3">
                                Professional challenging opens doors to opportunities physicians wouldn't consider otherwise. It's about understanding the NEED behind their preference, not arguing with them.
                            </div>
                            <div class="bg-indigo-100 p-3 rounded text-xs text-indigo-900">
                                <strong>The Formula:</strong> Acknowledge preference √¢‚Ä†‚Äô Explore underlying need √¢‚Ä†‚Äô Offer alternative solution
                            </div>
                        </div>

                        <div class="space-y-3">
                            ${currentSpecialty.challengingOpportunities
                              .map(
                                (script) => `
                                <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded-lg">
                                    <div class="text-sm italic text-purple-800 mb-2">"${script}"</div>
                                    <div class="text-xs text-purple-700 bg-purple-100 p-2 rounded">
                                        <strong>Why this works:</strong> Focuses on needs rather than preferences, opening flexibility without pressure.
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-lg">
                            <div class="font-bold text-green-900 mb-2">√¢≈ì‚Ä¶ When to Challenge</div>
                            <div class="text-sm text-green-800 space-y-1">
                                <div>√¢‚Ç¨¬¢ Physician has very narrow geographic parameters</div>
                                <div>√¢‚Ç¨¬¢ Compensation expectations 20%+ above market</div>
                                <div>√¢‚Ç¨¬¢ Requirements that eliminate 90%+ of opportunities</div>
                                <div>√¢‚Ç¨¬¢ Surface-level preferences (not needs)</div>
                                <div>√¢‚Ç¨¬¢ "Must-haves" that conflict with stated priorities</div>
                            </div>
                        </div>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                            <div class="font-bold text-blue-900 mb-2">√∞≈∏≈Ω¬Ø Challenge Templates</div>
                            <div class="space-y-2 text-sm text-blue-800">
                                <div class="border-b border-blue-200 pb-2">
                                    <strong>Geographic Flexibility:</strong>
                                    <p class="italic mt-1">"You mentioned wanting [specific location]. Help me understand what NEED that location solves for you - because there might be other places that meet that same need in ways you haven't considered."</p>
                                </div>
                                <div class="border-b border-blue-200 pb-2">
                                    <strong>Compensation Reality:</strong>
                                    <p class="italic mt-1">"I want to be transparent with you. The market for ${
                                      currentSpecialty.name
                                    } in [location] typically ranges [range]. If we could address [other priority] exceptionally well, how would that affect your compensation flexibility?"</p>
                                </div>
                                <div>
                                    <strong>Broadening Scope:</strong>
                                    <p class="italic mt-1">"Many physicians I work with start with similar parameters but end up in positions that don't match their original criteria - yet they're thrilled. What matters more to you: the specific label/location, or the actual quality of life and practice you're seeking?"</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-red-50 border border-red-500 p-4 rounded-lg">
                            <div class="font-bold text-red-900 mb-2">√∞≈∏≈°¬´ What NOT to Do</div>
                            <div class="text-sm text-red-800 space-y-1">
                                <div>√¢¬ù≈í "You're being unrealistic" (confrontational)</div>
                                <div>√¢¬ù≈í "Nobody pays that" (dismissive)</div>
                                <div>√¢¬ù≈í "You need to be more flexible" (demanding)</div>
                                <div>√¢≈ì‚Ä¶ Instead: Focus on needs, use hypotheticals, stay curious</div>
                            </div>
                        </div>
                    </div>
                `;
        }

        if (tab === "closing") {
          return `
                    <div class="space-y-4">
                        <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-lg">
                            <div class="font-bold text-red-900 mb-2 flex items-center">
                                <span class="mr-2">√¢≈°¬†√Ø¬∏¬è</span>
                                CRITICAL: Check Qualification Status First
                            </div>
                            <div class="text-sm text-red-800">
                                Before presenting ANY opportunity, ensure your qualification checklist shows all critical areas complete. Presenting too early = sequence violation = major score penalty.
                            </div>
                        </div>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                            <div class="font-bold text-blue-900 mb-2">1√Ø¬∏¬è√¢∆í¬£ PROFESSIONAL CLARIFICATION</div>
                            <div class="text-sm italic text-blue-800 mb-2">
                                "Let me share back what I'm hearing is most important to you: [summarize priorities, pain points, and must-haves]. What did I miss or get wrong?"
                            </div>
                            <div class="text-xs text-blue-700 bg-blue-100 p-2 rounded">
                                <strong>Why this works:</strong> Confirms understanding before presenting, shows you listened, invites correction. This is your last chance to catch missing qualification.
                            </div>
                        </div>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-lg">
                            <div class="font-bold text-green-900 mb-2">2√Ø¬∏¬è√¢∆í¬£ REFLECTIVE INTRODUCTION</div>
                            <div class="text-sm italic text-green-800 mb-2">
                                "Based on what you've shared about [specific pain/priority], I have an opportunity that might address that. Let me tell you why I think this could be a fit..."
                            </div>
                            <div class="text-xs text-green-700 bg-green-100 p-2 rounded">
                                <strong>Why this works:</strong> Connects opportunity directly to their stated needs, not generic features. Shows strategic thinking, not transactional matching.
                            </div>
                        </div>

                        <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded-lg">
                            <div class="font-bold text-purple-900 mb-2">3√Ø¬∏¬è√¢∆í¬£ FEATURE-BENEFIT ALIGNMENT</div>
                            <div class="text-sm text-purple-800 mb-3">
                                <strong>Always connect features to their stated needs:</strong>
                            </div>
                            <div class="space-y-2 text-sm italic text-purple-800">
                                <div class="bg-purple-100 p-2 rounded">
                                    "You mentioned [pain point]. This practice addresses that by [specific feature]..."
                                </div>
                                <div class="bg-purple-100 p-2 rounded">
                                    "Since you prioritized [motivation], you'll appreciate that [specific benefit]..."
                                </div>
                                <div class="bg-purple-100 p-2 rounded">
                                    "Based on your family's need for [factor], the community offers [specific amenity]..."
                                </div>
                            </div>
                        </div>

                        <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-lg">
                            <div class="font-bold text-orange-900 mb-2">4√Ø¬∏¬è√¢∆í¬£ HANDLING MISALIGNMENT</div>
                            <div class="text-sm text-orange-800 mb-2">
                                If compensation or another factor doesn't perfectly align:
                            </div>
                            <div class="text-sm italic text-orange-800 mb-2">
                                "I want to be transparent with you. The compensation for this opportunity is [amount], which is [relationship to their expectation]. Before we dismiss it, help me understand what's most important to you - the total package, the base, the growth potential, the lifestyle factors, or something else?"
                            </div>
                            <div class="text-xs text-orange-700 bg-orange-100 p-2 rounded">
                                <strong>Why this works:</strong> Honesty builds trust. Exploring flexibility on other factors can overcome compensation gaps. Misalignment √¢‚Ä∞¬† automatic disqualification.
                            </div>
                        </div>

                        <div class="bg-indigo-50 border-l-4 border-indigo-500 p-4 rounded-lg">
                            <div class="font-bold text-indigo-900 mb-2">5√Ø¬∏¬è√¢∆í¬£ COMMUNITY PRESENTATION</div>
                            <div class="text-sm text-indigo-800 mb-2">
                                <strong>Best Practice:</strong> Start broad (region) √¢‚Ä†‚Äô narrow to state √¢‚Ä†‚Äô specific community
                            </div>
                            <div class="text-sm italic text-indigo-800">
                                "Based on your interest in [family need/lifestyle], let me share what makes this region special... [regional features]. The specific community offers [local features] that align with what you described wanting..."
                            </div>
                        </div>

                        <div class="bg-yellow-50 border border-yellow-500 p-4 rounded-lg">
                            <div class="font-bold text-yellow-900 mb-2">√¢≈°¬†√Ø¬∏¬è Presentation Red Flags</div>
                            <div class="text-sm text-yellow-800 space-y-1">
                                <div>√¢¬ù≈í "This is perfect for you" (before understanding them)</div>
                                <div>√¢¬ù≈í Generic feature dump without connection to needs</div>
                                <div>√¢¬ù≈í No reflective statement before presenting</div>
                                <div>√¢¬ù≈í Presenting multiple opportunities without prioritization</div>
                                <div>√¢≈ì‚Ä¶ One well-matched opportunity > three mediocre ones</div>
                            </div>
                        </div>
                    </div>

                        <!-- Closing & Next Steps -->
                        <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg p-4 mt-4">
                            <div class="font-bold text-xl mb-2">ü§ù After Presentation: Strong Closing</div>
                            <div class="text-sm opacity-90">
                                Once you've presented the opportunity, transition to setting clear next steps and commitments.
                            </div>
                        </div>

                    <div class="space-y-4">
                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-lg">
                            <div class="font-bold text-green-900 mb-2">√∞≈∏¬§¬ù STRONG CLOSING FRAMEWORK</div>
                            <div class="text-sm text-green-800 mb-3">
                                Always end with clear next steps, mutual commitments, and specific timeline:
                            </div>
                            <div class="text-sm italic text-green-800 bg-green-100 p-3 rounded">
                                "Based on our conversation, here's what I'll do: [specific actions with timeline]. On your end, I'd like you to [specific requests]. Let's reconnect on [specific day/time] to discuss. Does that work for you?"
                            </div>
                        </div>

                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                            <div class="font-bold text-blue-900 mb-2">√∞≈∏‚Äú‚Äπ NEXT STEPS CHECKLIST</div>
                            <div class="text-sm text-blue-800 space-y-2">
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span><strong>Your commitments:</strong> Email opportunity details, coordinate with client, research specific questions</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span><strong>Their commitments:</strong> Review materials, discuss with spouse/family, prepare questions</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span><strong>Specific timing:</strong> "Tuesday at 2pm" not "early next week"</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span><strong>Confirmation:</strong> "Does that work for you?" - get verbal agreement</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded-lg">
                            <div class="font-bold text-purple-900 mb-2">√∞≈∏‚Äô¬º CONTACT INFORMATION</div>
                            <div class="text-sm italic text-purple-800 mb-2">
                                "What's the best email to send these details? And the best phone number to reach you? What's your preferred time for follow-up calls?"
                            </div>
                            <div class="text-xs text-purple-700 bg-purple-100 p-2 rounded">
                                Get multiple contact methods and preference for communication. This prevents "ghosting" situations.
                            </div>
                        </div>

                        <div class="bg-indigo-50 border-l-4 border-indigo-500 p-4 rounded-lg">
                            <div class="font-bold text-indigo-900 mb-2">√∞≈∏≈Ω¬Ø INTEREST LEVEL GAUGE</div>
                            <div class="text-sm italic text-indigo-800 mb-2">
                                "On a scale of 1-10, where 10 is 'I want to interview tomorrow' and 1 is 'not interested at all,' where are you on this opportunity?"
                            </div>
                            <div class="text-xs text-indigo-700 bg-indigo-100 p-2 rounded">
                                Their number tells you everything about urgency and likelihood. If under 7, dig deeper: "What would need to change to make this a 9 or 10?"
                            </div>
                        </div>

                        <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-lg">
                            <div class="font-bold text-orange-900 mb-2">√∞≈∏≈°‚Ç¨ MOMENTUM BUILDERS</div>
                            <div class="text-sm text-orange-800 space-y-2">
                                <div>
                                    <strong>If highly interested:</strong>
                                    <p class="italic mt-1">"I'd like to get you on the client's calendar this week if possible. What days work best for a preliminary call?"</p>
                                </div>
                                <div>
                                    <strong>If moderate interest:</strong>
                                    <p class="italic mt-1">"What additional information would help you decide if this is worth exploring further?"</p>
                                </div>
                                <div>
                                    <strong>If low interest:</strong>
                                    <p class="italic mt-1">"Help me understand what's holding you back - is it [factor], [factor], or something else entirely?"</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-red-50 border border-red-500 p-4 rounded-lg">
                            <div class="font-bold text-red-900 mb-2">√∞≈∏≈°¬´ Weak Closing Mistakes</div>
                            <div class="text-sm text-red-800 space-y-1">
                                <div>√¢¬ù≈í "I'll send you some information" (vague)</div>
                                <div>√¢¬ù≈í "Let me know if you're interested" (puts burden on them)</div>
                                <div>√¢¬ù≈í "I'll follow up soon" (no specific timeline)</div>
                                <div>√¢¬ù≈í No mutual commitments or next steps</div>
                                <div>√¢≈ì‚Ä¶ Always end with specific actions, timing, and agreement</div>
                            </div>
                        </div>

                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-lg">
                            <div class="font-bold text-green-900 mb-2">√∞≈∏‚Äú¬ù IMMEDIATE POST-CALL ACTIONS</div>
                            <div class="text-sm text-green-800 space-y-1">
                                <div>1. Document everything in Bullhorn immediately</div>
                                <div>2. Send follow-up email within 30 minutes</div>
                                <div>3. Calendar reminder for follow-up call</div>
                                <div>4. Alert client if physician is highly qualified and interested</div>
                                <div>5. Prepare any additional materials promised</div>
                            </div>
                        </div>
                    </div>
                `;
        }


        return "";
      }

      function renderSpecialtyGuide() {
        const currentSpecialty = specialtyData[state.activeSpecialty];

        return `
                <div class="space-y-6">
                    <!-- Specialty Selector -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <label class="block text-sm font-semibold mb-3">Select Specialty:</label>
                        <select
                            onchange="state.activeSpecialty = this.value; render();"
                            class="w-full md:w-96 p-3 border-2 rounded-lg font-medium bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600"
                        >
                            ${Object.entries(specialtyData)
                              .map(
                                ([key, spec]) =>
                                  `<option value="${key}" ${
                                    state.activeSpecialty === key
                                      ? "selected"
                                      : ""
                                  }>${spec.icon} ${spec.name}</option>`
                              )
                              .join("")}
                        </select>
                    </div>

                    <!-- Specialty Overview -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h2 class="text-3xl font-bold mb-6 flex items-center">
                            <span class="mr-3">${currentSpecialty.icon}</span>
                            ${currentSpecialty.name}
                        </h2>

                        <!-- Compensation Data -->
                        <div class="mb-6 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-5 border-l-4 border-green-500">
                            <h3 class="font-bold text-lg mb-4 text-green-800">√∞≈∏‚Äô¬∞ MGMA 2025 Compensation Data</h3>
                            <div class="grid md:grid-cols-3 gap-4">
                                <div class="text-center">
                                    <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">25th Percentile</div>
                                    <div class="text-xl font-bold text-green-700">${
                                      currentSpecialty.compensation.percentile25
                                    }</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Median (50th)</div>
                                    <div class="text-2xl font-bold text-green-800">${
                                      currentSpecialty.compensation.percentile50
                                    }</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">75th Percentile</div>
                                    <div class="text-xl font-bold text-green-700">${
                                      currentSpecialty.compensation.percentile75
                                    }</div>
                                </div>
                            </div>
                            <div class="mt-3 text-xs text-green-700 text-center">
                                Full range: ${
                                  currentSpecialty.compensation.range
                                }
                            </div>
                        </div>

                        <!-- Pain Points -->
                        <div class="mb-6">
                            <h3 class="font-bold text-lg mb-4 flex items-center">
                                <span class="mr-2">√∞≈∏‚Äù¬ç</span>
                                Common Pain Points & Frustrations
                            </h3>
                            <div class="grid md:grid-cols-${
                              currentSpecialty.painPoints.length
                            } gap-4">
                                ${currentSpecialty.painPoints
                                  .map(
                                    (category) => `
                                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                        <div class="font-bold text-red-800 mb-3">${
                                          category.category
                                        }</div>
                                        <ul class="space-y-2 text-sm text-red-700">
                                            ${category.points
                                              .map(
                                                (point) => `
                                                <li class="flex items-start">
                                                    <span class="mr-2 mt-1">√¢‚Ç¨¬¢</span>
                                                    <span>${point}</span>
                                                </li>
                                            `
                                              )
                                              .join("")}
                                        </ul>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <!-- Motivations -->
                        <div class="mb-6">
                            <h3 class="font-bold text-lg mb-4 flex items-center">
                                <span class="mr-2">√∞≈∏≈Ω¬Ø</span>
                                Common Motivations & Priorities
                            </h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-5">
                                <div class="grid md:grid-cols-2 gap-3">
                                    ${currentSpecialty.motivations
                                      .map(
                                        (motivation) => `
                                        <div class="flex items-start text-sm text-blue-800">
                                            <span class="text-blue-500 mr-2 mt-1">√¢≈ì‚Äú</span>
                                            <span>${motivation}</span>
                                        </div>
                                    `
                                      )
                                      .join("")}
                                </div>
                            </div>
                        </div>

                        <!-- Key Questions by Category -->
                        <div class="mb-6">
                            <h3 class="font-bold text-lg mb-4 flex items-center">
                                <span class="mr-2">√¢¬ù‚Äú</span>
                                Discovery Questions by Phase
                            </h3>
                            <div class="space-y-4">
                                ${Object.entries(currentSpecialty.keyQuestions)
                                  .map(
                                    ([category, questions]) => `
                                    <div class="border-l-4 ${
                                      category === "opening"
                                        ? "border-blue-500 bg-blue-50"
                                        : category === "painDiscovery"
                                        ? "border-red-500 bg-red-50"
                                        : category === "clinical"
                                        ? "border-green-500 bg-green-50"
                                        : category === "motivation"
                                        ? "border-purple-500 bg-purple-50"
                                        : "border-orange-500 bg-orange-50"
                                    } rounded-lg p-4">
                                        <div class="font-bold mb-2 capitalize ${
                                          category === "opening"
                                            ? "text-blue-900"
                                            : category === "painDiscovery"
                                            ? "text-red-900"
                                            : category === "clinical"
                                            ? "text-green-900"
                                            : category === "motivation"
                                            ? "text-purple-900"
                                            : "text-orange-900"
                                        }">
                                            ${
                                              category === "painDiscovery"
                                                ? "√∞≈∏‚Äù¬ç Pain Discovery"
                                                : category === "opening"
                                                ? "√∞≈∏‚Äò‚Äπ Opening Questions"
                                                : category === "clinical"
                                                ? "√∞≈∏¬è¬• Clinical Discovery"
                                                : category === "motivation"
                                                ? "√∞≈∏≈Ω¬Ø Motivation Discovery"
                                                : "√∞≈∏‚Äô¬∞ Compensation Discovery"
                                            }
                                        </div>
                                        <ul class="space-y-2 text-sm ${
                                          category === "opening"
                                            ? "text-blue-800"
                                            : category === "painDiscovery"
                                            ? "text-red-800"
                                            : category === "clinical"
                                            ? "text-green-800"
                                            : category === "motivation"
                                            ? "text-purple-800"
                                            : "text-orange-800"
                                        }">
                                            ${questions
                                              .map(
                                                (q) => `
                                                <li class="flex items-start">
                                                    <span class="mr-2 mt-1">√¢‚Ç¨¬¢</span>
                                                    <span class="italic">"${q}"</span>
                                                </li>
                                            `
                                              )
                                              .join("")}
                                        </ul>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <!-- Common Challenges -->
                        <div class="mb-6">
                            <h3 class="font-bold text-lg mb-4 flex items-center">
                                <span class="mr-2">√¢≈°¬†√Ø¬∏¬è</span>
                                Common Objections & Responses
                            </h3>
                            <div class="space-y-3">
                                ${currentSpecialty.commonChallenges
                                  .map(
                                    (item) => `
                                    <div class="bg-yellow-50 border-l-4 border-yellow-500 rounded-lg p-4">
                                        <div class="font-bold text-yellow-900 mb-2">
                                            √∞≈∏‚Äô¬¨ "${item.challenge}"
                                        </div>
                                        <div class="text-sm italic text-yellow-800">
                                            Response: "${item.response}"
                                        </div>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>

                        <!-- Professional Challenging Scripts -->
                        <div class="bg-purple-50 border-l-4 border-purple-500 rounded-lg p-5">
                            <h3 class="font-bold text-lg mb-3 text-purple-900">
                                √∞≈∏‚Äô¬™ Professional Challenging Scripts
                            </h3>
                            <div class="space-y-3">
                                ${currentSpecialty.challengingOpportunities
                                  .map(
                                    (script) => `
                                    <div class="bg-white dark:bg-gray-800 border border-purple-200 dark:border-purple-700 rounded p-3 text-sm italic text-purple-800 dark:text-purple-100">
                                      "${script}"
                                  </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      function renderQuestionQuality() {
        return `
                <div class="space-y-6">
                    <!-- Framework Overview -->
                    <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl p-8 shadow-2xl">
                        <h2 class="text-3xl font-bold mb-3 flex items-center">
                            <span class="mr-3">√¢¬ù‚Äú</span>
                            The 80/20 Question Quality Rule
                        </h2>
                        <p class="text-lg opacity-95 mb-4">
                            Excellence requires 80% open-ended questions. This single metric differentiates top performers from average recruiters.
                        </p>
                        <div class="bg-white dark:bg-gray-800 bg-opacity-20 rounded-lg p-4">
                            <div class="text-2xl font-bold mb-2">Core Principle:</div>
                            <div class="text-lg italic">
                                "Physicians are only required to answer the questions you ask. Surface-level questions = surface-level answers. Strategic, open-ended questions = deep insights."
                            </div>
                        </div>
                    </div>

                    <!-- Open vs Closed Comparison -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-t-4 border-green-500">
                            <h3 class="font-bold text-xl mb-4 text-green-700 flex items-center">
                                <span class="mr-2">√¢≈ì‚Ä¶</span>
                                Open-Ended Questions
                            </h3>
                            <div class="mb-4 text-sm text-gray-700 dark:text-gray-300">
                                Require explanation, invite storytelling, uncover deeper insights. Cannot be answered with yes/no.
                            </div>
                            <div class="space-y-3">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                    <div class="font-semibold text-green-800 mb-1">Starters to Use:</div>
                                    <div class="text-sm text-green-700 space-y-1">
                                        <div>√¢‚Ç¨¬¢ "Tell me about..."</div>
                                        <div>√¢‚Ç¨¬¢ "Help me understand..."</div>
                                        <div>√¢‚Ç¨¬¢ "Walk me through..."</div>
                                        <div>√¢‚Ç¨¬¢ "Describe for me..."</div>
                                        <div>√¢‚Ç¨¬¢ "Share with me..."</div>
                                        <div>√¢‚Ç¨¬¢ "What's your experience with..."</div>
                                        <div>√¢‚Ç¨¬¢ "Explain to me..."</div>
                                        <div>√¢‚Ç¨¬¢ "What's the story behind..."</div>
                                    </div>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                    <div class="font-semibold text-green-800 mb-2">Examples:</div>
                                    <div class="text-sm italic text-green-700 space-y-2">
                                        <div>√¢≈ì‚Äú "Tell me about your current practice structure"</div>
                                        <div>√¢≈ì‚Äú "Help me understand what's driving you to explore new opportunities"</div>
                                        <div>√¢≈ì‚Äú "Walk me through a typical day in your current role"</div>
                                        <div>√¢≈ì‚Äú "Describe your ideal patient population"</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-t-4 border-red-500">
                            <h3 class="font-bold text-xl mb-4 text-red-700 flex items-center">
                                <span class="mr-2">√¢¬ù≈í</span>
                                Closed-Ended Questions
                            </h3>
                            <div class="mb-4 text-sm text-gray-700 dark:text-gray-300">
                                Can be answered with yes/no or single fact. Limit discovery and create interrogation feel.
                            </div>
                            <div class="space-y-3">
                                <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                    <div class="font-semibold text-red-800 mb-1">Starters to Avoid:</div>
                                    <div class="text-sm text-red-700 space-y-1">
                                        <div>√¢‚Ç¨¬¢ "Do you..."</div>
                                        <div>√¢‚Ç¨¬¢ "Are you..."</div>
                                        <div>√¢‚Ç¨¬¢ "Can you..."</div>
                                        <div>√¢‚Ç¨¬¢ "Will you..."</div>
                                        <div>√¢‚Ç¨¬¢ "Have you..."</div>
                                        <div>√¢‚Ç¨¬¢ "Is there..."</div>
                                        <div>√¢‚Ç¨¬¢ "Would you..."</div>
                                        <div>√¢‚Ç¨¬¢ "Could you..."</div>
                                    </div>
                                </div>
                                <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                    <div class="font-semibold text-red-800 mb-2">Examples:</div>
                                    <div class="text-sm italic text-red-700 space-y-2">
                                        <div>√¢≈ì‚Äî "Do you see pediatric patients?"</div>
                                        <div>√¢≈ì‚Äî "Are you board certified?"</div>
                                        <div>√¢≈ì‚Äî "Can you work weekends?"</div>
                                        <div>√¢≈ì‚Äî "Have you used Epic EMR?"</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Conversion Practice -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äù‚Äû</span>
                            Conversion Practice: Transform Closed to Open
                        </h3>
                        <div class="space-y-4">
                            ${[
                              {
                                closed: "Do you see pediatric patients?",
                                open: "Tell me about your patient population - what age ranges do you see?",
                                why: "Reveals scope, comfort level, and preferences rather than just yes/no",
                              },
                              {
                                closed: "Are you willing to relocate?",
                                open: "Share with me your flexibility regarding location and what factors influence that",
                                why: "Uncovers decision influences and degree of flexibility, not binary answer",
                              },
                              {
                                closed: "Do you want better work-life balance?",
                                open: "Help me understand what better work-life balance looks like to you",
                                why: "Reveals specific needs and definitions rather than assumed understanding",
                              },
                              {
                                closed: "Have you interviewed anywhere else?",
                                open: "Tell me about the other opportunities you're exploring and what's attractive about each",
                                why: "Provides competitive intelligence and decision criteria vs. simple yes/no",
                              },
                              {
                                closed: "Is compensation important to you?",
                                open: "Help me understand how compensation ranks among your priorities for your next move",
                                why: "Reveals relative importance and trade-off considerations",
                              },
                              {
                                closed: "Can you start in 90 days?",
                                open: "Describe your notice requirements and timeline for transition",
                                why: "Uncovers constraints and potential flexibility vs. yes/no",
                              },
                            ]
                              .map(
                                (example) => `
                                <div class="border rounded-lg overflow-hidden">
                                    <div class="bg-red-50 p-4 border-b">
                                        <div class="text-xs font-bold text-red-700 mb-1">√¢¬ù≈í CLOSED QUESTION:</div>
                                        <div class="text-sm text-red-800">"${example.closed}"</div>
                                    </div>
                                    <div class="bg-green-50 p-4 border-b">
                                        <div class="text-xs font-bold text-green-700 mb-1">√¢≈ì‚Ä¶ OPEN-ENDED VERSION:</div>
                                        <div class="text-sm italic text-green-800">"${example.open}"</div>
                                    </div>
                                    <div class="bg-blue-50 p-4">
                                        <div class="text-xs font-bold text-blue-700 mb-1">√∞≈∏‚Äô¬° WHY THIS WORKS BETTER:</div>
                                        <div class="text-xs text-blue-800">${example.why}</div>
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>

                    <!-- The Curiosity Loop -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äù¬Å</span>
                            The Curiosity Loop: Asking "Why"
                        </h3>
                        <div class="mb-4 p-4 bg-purple-50 border-l-4 border-purple-500 rounded">
                            <div class="font-bold text-purple-900 mb-2">Core Technique:</div>
                            <div class="text-purple-800">
                                After EVERY answer, pause and ask yourself: "What's behind this?" Then ask the physician using varied "why" equivalents.
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <div class="font-bold text-purple-900 mb-3">"Why" Alternatives:</div>
                                <div class="space-y-2 text-sm text-purple-800">
                                    <div>√¢‚Ç¨¬¢ "Help me understand what's behind that..."</div>
                                    <div>√¢‚Ç¨¬¢ "Tell me more about what drives that preference..."</div>
                                    <div>√¢‚Ç¨¬¢ "Walk me through your thinking on that..."</div>
                                    <div>√¢‚Ç¨¬¢ "What's the story behind that decision?"</div>
                                    <div>√¢‚Ç¨¬¢ "Explain what led you to that conclusion..."</div>
                                    <div>√¢‚Ç¨¬¢ "Share more about that situation..."</div>
                                    <div>√¢‚Ç¨¬¢ "What's driving that need?"</div>
                                    <div>√¢‚Ç¨¬¢ "How did you arrive at that?"</div>
                                </div>
                            </div>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="font-bold text-blue-900 mb-3">Example Dialogue:</div>
                                <div class="space-y-3 text-sm">
                                    <div>
                                        <div class="font-semibold text-blue-800">Physician:</div>
                                        <div class="text-blue-700 italic">"I'm looking for better work-life balance."</div>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-green-800">You (Level 1):</div>
                                        <div class="text-green-700 italic">"Help me understand what better work-life balance looks like to you..."</div>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-blue-800">Physician:</div>
                                        <div class="text-blue-700 italic">"I want to be home for dinner with my family."</div>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-green-800">You (Level 2):</div>
                                        <div class="text-green-700 italic">"Tell me more about what's important about those family dinners..."</div>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-blue-800">Physician:</div>
                                        <div class="text-blue-700 italic">"My kids are getting older and I'm missing important moments..."</div>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-green-800">You (Level 3):</div>
                                        <div class="text-green-700 italic">"What impact is that having on you and your relationships?"</div>
                                    </div>
                                </div>
                                <div class="mt-3 p-2 bg-blue-100 rounded text-xs text-blue-900">
                                    <strong>Result:</strong> You've moved from surface preference to deep emotional motivation. Now you can position opportunities based on real needs.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Practice Plan -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏≈Ω¬Ø</span>
                            Your Question Quality Development Plan
                        </h3>
                        <div class="space-y-4">
                            <div class="bg-green-50 border-l-4 border-green-500 rounded-lg p-4">
                                <div class="font-bold text-green-900 mb-2">Week 1-2: Master the 80/20 Rule</div>
                                <div class="text-sm text-green-800 space-y-2">
                                    <div><strong>Goal:</strong> Achieve 80% open-ended questions consistently</div>
                                    <div><strong>Daily Practice:</strong> Before each call, write 10 open-ended questions</div>
                                    <div><strong>Success Metric:</strong> Track your ratio after each call using the live counter</div>
                                    <div><strong>Quick Win:</strong> Keep a card visible with "Tell me / Help me understand / Describe"</div>
                                </div>
                            </div>
                            <div class="bg-purple-50 border-l-4 border-purple-500 rounded-lg p-4">
                                <div class="font-bold text-purple-900 mb-2">Week 3-4: Deepen with "Why"</div>
                                <div class="text-sm text-purple-800 space-y-2">
                                    <div><strong>Goal:</strong> Ask minimum 5 "why" follow-ups per call</div>
                                    <div><strong>Daily Practice:</strong> After every answer, ask yourself "What's behind this?"</div>
                                    <div><strong>Success Metric:</strong> Use the Pain Discovery Depth meter during calls</div>
                                    <div><strong>Quick Win:</strong> Master the phrase "Help me understand what's behind that..."</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Impact Visualization -->
                    <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl p-6">
                        <h3 class="font-bold text-xl mb-4">√∞≈∏‚Äô¬° The Impact of Question Quality</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <div class="text-lg font-bold mb-2">50% Open-Ended Ratio:</div>
                                <div class="text-sm opacity-90 space-y-1">
                                    <div>√¢‚Ä†‚Äô Surface-level information</div>
                                    <div>√¢‚Ä†‚Äô Feels like interrogation</div>
                                    <div>√¢‚Ä†‚Äô Physician holds back</div>
                                    <div>√¢‚Ä†‚Äô Weak positioning</div>
                                    <div>√¢‚Ä†‚Äô Low placement rate</div>
                                </div>
                            </div>
                            <div>
                                <div class="text-lg font-bold mb-2">80% Open-Ended Ratio:</div>
                                <div class="text-sm opacity-90 space-y-1">
                                    <div>√¢‚Ä†‚Äô Deep insights uncovered</div>
                                    <div>√¢‚Ä†‚Äô Feels consultative</div>
                                    <div>√¢‚Ä†‚Äô Physician opens up</div>
                                    <div>√¢‚Ä†‚Äô Strong positioning</div>
                                    <div>√¢‚Ä†‚Äô High placement rate</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      function renderProfessionalChallenging() {
        return `
                <div class="space-y-6">
                    <!-- Framework Overview -->
                    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-8 shadow-2xl">
                        <h2 class="text-3xl font-bold mb-3 flex items-center">
                            <span class="mr-3">√∞≈∏‚Äô¬™</span>
                            Professional Challenging Framework
                        </h2>
                        <p class="text-lg opacity-95 mb-4">
                            Professional challenging opens doors to opportunities physicians wouldn't consider otherwise. It's about understanding needs behind preferences, not arguing with candidates.
                        </p>
                        <div class="bg-white dark:bg-gray-800 bg-opacity-20 rounded-lg p-4">
                            <div class="text-xl font-bold mb-2">The Formula:</div>
                            <div class="text-lg">
                                Acknowledge Preference √¢‚Ä†‚Äô Explore Underlying Need √¢‚Ä†‚Äô Offer Alternative Solution
                            </div>
                        </div>
                    </div>

                    <!-- When to Challenge -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏≈Ω¬Ø</span>
                            When to Use Professional Challenging
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-green-50 border-l-4 border-green-500 rounded-lg p-4">
                                <div class="font-bold text-green-900 mb-3">√¢≈ì‚Ä¶ Good Opportunities to Challenge:</div>
                                <div class="text-sm text-green-800 space-y-2">
                                    <div>√¢‚Ç¨¬¢ Very narrow geographic parameters (one city only)</div>
                                    <div>√¢‚Ç¨¬¢ Compensation 20%+ above market range</div>
                                    <div>√¢‚Ç¨¬¢ Requirements eliminating 90%+ of opportunities</div>
                                    <div>√¢‚Ç¨¬¢ Surface-level preferences vs. deep needs</div>
                                    <div>√¢‚Ç¨¬¢ "Must-haves" conflicting with stated priorities</div>
                                    <div>√¢‚Ç¨¬¢ Unrealistic expectations based on incomplete information</div>
                                </div>
                            </div>
                            <div class="bg-red-50 border-l-4 border-red-500 rounded-lg p-4">
                                <div class="font-bold text-red-900 mb-3">√¢¬ù≈í When NOT to Challenge:</div>
                                <div class="text-sm text-red-800 space-y-2">
                                    <div>√¢‚Ç¨¬¢ Non-negotiable family factors (spouse job, aging parents)</div>
                                    <div>√¢‚Ç¨¬¢ Medical/health limitations</div>
                                    <div>√¢‚Ç¨¬¢ Deep-seated values or religious requirements</div>
                                    <div>√¢‚Ç¨¬¢ Recent trauma or life events</div>
                                    <div>√¢‚Ç¨¬¢ When they've already thoroughly explored alternatives</div>
                                    <div>√¢‚Ç¨¬¢ Aggressive or defensive tone from physician</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- The Framework -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äú‚Äπ</span>
                            The 3-Step Challenging Process
                        </h3>
                        <div class="space-y-4">
                            <div class="border-l-4 border-blue-500 bg-blue-50 rounded-lg p-5">
                                <div class="flex items-center mb-3">
                                    <div class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold mr-3">1</div>
                                    <div class="font-bold text-blue-900 text-lg">Acknowledge the Preference</div>
                                </div>
                                <div class="text-sm text-blue-800 mb-3">
                                    Reflect back what they said without judgment. This shows you're listening and respect their perspective.
                                </div>
                                <div class="bg-white dark:bg-gray-700 border border-blue-200 dark:border-blue-700 rounded p-3 text-sm italic text-blue-900 dark:text-blue-200">
                                    "I hear that you prefer [specific preference/requirement]. That makes sense given [what they told you]..."
                                </div>
                            </div>

                            <div class="border-l-4 border-purple-500 bg-purple-50 rounded-lg p-5">
                                <div class="flex items-center mb-3">
                                    <div class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold mr-3">2</div>
                                    <div class="font-bold text-purple-900 text-lg">Explore the Underlying Need</div>
                                </div>
                                <div class="text-sm text-purple-800 mb-3">
                                    Ask open-ended questions to understand what problem their preference solves. Often the real need can be met differently.
                                </div>
                                <div class="bg-white dark:bg-gray-700 border border-purple-200 dark:border-purple-700 rounded p-3 space-y-2">
                                    <div class="text-sm italic text-purple-900 dark:text-purple-100">
                                        "Help me understand what NEED that preference is solving for you..."
                                    </div>
                                    <div class="text-sm italic text-purple-900 dark:text-purple-100">
                                        "What's driving that requirement? What problem does it solve?"
                                    </div>
                                    <div class="text-sm italic text-purple-900 dark:text-purple-100">
                                        "If we could address [underlying need] in a different way, how flexible might you be?"
                                    </div>
                                </div>
                            </div>

                            <div class="border-l-4 border-green-500 bg-green-50 rounded-lg p-5">
                                <div class="flex items-center mb-3">
                                    <div class="bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold mr-3">3</div>
                                    <div class="font-bold text-green-900 text-lg">Offer Alternative Solution</div>
                                </div>
                                <div class="text-sm text-green-800 mb-3">
                                    Present a hypothetical scenario that addresses their underlying need through a different approach.
                                </div>
                                <div class="bg-white dark:bg-gray-700 border border-green-200 dark:border-green-700 rounded p-3 text-sm italic text-green-900 dark:text-green-100">
                                    "What if I could find an opportunity that [addresses underlying need] but in [different location/structure/way]? Would that be worth exploring?"
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Common Scenarios with Scripts -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äô¬¨</span>
                            Common Scenarios & Challenge Scripts
                        </h3>
                        <div class="space-y-4">
                            ${[
                              {
                                scenario: "Geographic Rigidity",
                                preference:
                                  '"I only want to practice in Boston."',
                                need: "Access to culture, education, family nearby, job for spouse",
                                script:
                                  "You mentioned Boston specifically. Help me understand what NEED Boston solves for you - is it the culture, proximity to family, job opportunities for your spouse, the educational system? Because there might be other locations that meet those same needs in ways you haven't considered...",
                                outcome:
                                  "Opens consideration to similar cities (Seattle, Denver, etc.)",
                              },
                              {
                                scenario: "Compensation Above Market",
                                preference:
                                  '"I need to make $500k+ base salary."',
                                need: "Student loan repayment, lifestyle goals, feeling valued",
                                script:
                                  "I want to be transparent with you. The market for your specialty typically ranges $400-450k base in most areas. Before we dismiss opportunities in that range, help me understand what's driving the $500k target. Is it loan repayment, retirement planning, specific lifestyle goals? Sometimes we can structure total compensation differently or address those underlying needs through signing bonuses, loan repayment, or other benefits...",
                                outcome:
                                  "Explores total package vs. base only, considers tradeoffs",
                              },
                              {
                                scenario: "Practice Setting Narrow",
                                preference: '"I only want private practice."',
                                need: "Autonomy, compensation model, schedule control",
                                script:
                                  "You mentioned preferring private practice. What is it about private practice that appeals to you - is it the autonomy, the compensation model, schedule control, something else? Because some hospital-employed positions offer those same benefits with less administrative burden. Would it be worth exploring if I could find something that gives you what you're really seeking?",
                                outcome:
                                  "Opens consideration to employed positions with autonomy",
                              },
                              {
                                scenario: "Patient Volume Unrealistic",
                                preference:
                                  '"I won\'t see more than 12 patients per day."',
                                need: "Quality time per patient, work-life balance, avoiding burnout",
                                script:
                                  "I hear that 12 patients feels right to you. Help me understand what's driving that number - is it the quality time per patient, the schedule you want to keep, avoiding burnout? Because some physicians find that 15-16 patients with good support staff and efficient systems feels better than 12 in a poorly-run practice. What if we focused on your underlying needs rather than the specific number?",
                                outcome:
                                  "Focuses on quality factors beyond just volume",
                              },
                              {
                                scenario: "No Relocation",
                                preference: '"I don\'t want to relocate."',
                                need: "Family stability, avoiding upheaval, comfort with known",
                                script:
                                  "I understand not wanting to uproot your family. Help me understand what you're trying to protect - is it your kids' school continuity, your spouse's career, proximity to family, something else? Because sometimes physicians find that a strategic move actually enhances those things rather than disrupting them. What would need to be true about a location for it to feel like an improvement rather than a sacrifice?",
                                outcome:
                                  "Opens consideration if benefits outweigh concerns",
                              },
                            ]
                              .map(
                                (item) => `
                                <div class="border rounded-lg overflow-hidden">
                                    <div class="bg-gradient-to-r from-indigo-100 to-purple-100 p-4 border-b">
                                        <div class="font-bold text-indigo-900 text-lg mb-1">${item.scenario}</div>
                                        <div class="text-sm text-indigo-700 italic">"${item.preference}"</div>
                                    </div>
                                    <div class="p-4 space-y-3">
                                        <div>
                                            <div class="text-xs font-bold text-gray-600 dark:text-gray-400 mb-1">UNDERLYING NEED:</div>
                                            <div class="text-sm text-gray-700 dark:text-gray-300">${item.need}</div>
                                        </div>
                                        <div>
                                            <div class="text-xs font-bold text-blue-600 mb-1">YOUR CHALLENGE SCRIPT:</div>
                                            <div class="text-sm italic text-blue-800 bg-blue-50 p-3 rounded">
                                                "${item.script}"
                                            </div>
                                        </div>
                                        <div>
                                            <div class="text-xs font-bold text-green-600 mb-1">DESIRED OUTCOME:</div>
                                            <div class="text-sm text-green-700">${item.outcome}</div>
                                        </div>
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>

                    <!-- What NOT to Do -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center text-red-700">
                            <span class="mr-2">√∞≈∏≈°¬´</span>
                            Professional Challenging Mistakes
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                <div class="font-bold text-red-900 mb-3">√¢¬ù≈í Wrong Approach:</div>
                                <div class="space-y-2 text-sm text-red-800">
                                    <div class="italic">"You're being unrealistic about compensation."</div>
                                    <div class="italic">"Nobody pays that much in that location."</div>
                                    <div class="italic">"You need to be more flexible."</div>
                                    <div class="italic">"That's not how the market works."</div>
                                    <div class="italic">"You'll never find that."</div>
                                </div>
                                <div class="mt-3 p-2 bg-red-100 rounded text-xs text-red-900">
                                    <strong>Why this fails:</strong> Confrontational, dismissive, creates defensiveness, damages rapport
                                </div>
                            </div>
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <div class="font-bold text-green-900 mb-3">√¢≈ì‚Ä¶ Right Approach:</div>
                                <div class="space-y-2 text-sm text-green-800">
                                    <div class="italic">"Help me understand what's behind that expectation..."</div>
                                    <div class="italic">"What NEED is that solving for you?"</div>
                                    <div class="italic">"If we could address [need] differently, would you be open?"</div>
                                    <div class="italic">"What would need to be true for this to work?"</div>
                                    <div class="italic">"Let me share what I'm seeing in the market..."</div>
                                </div>
                                <div class="mt-3 p-2 bg-green-100 rounded text-xs text-green-900">
                                    <strong>Why this works:</strong> Curious, respectful, collaborative, maintains rapport while expanding thinking
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Practice Exercise -->
                    <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl p-6">
                        <h3 class="font-bold text-xl mb-4">√∞≈∏≈Ω¬Ø Practice Exercise</h3>
                        <div class="bg-white dark:bg-gray-800 bg-opacity-20 rounded-lg p-4">
                            <div class="font-bold mb-3">On your next 3 calls, identify at least ONE opportunity to professionally challenge:</div>
                            <div class="space-y-2 text-sm opacity-95">
                                <div>1. Notice when physician states a narrow preference</div>
                                <div>2. Ask "Help me understand what NEED that solves for you..."</div>
                                <div>3. Listen for the underlying need</div>
                                <div>4. Offer alternative solution addressing that need</div>
                                <div>5. Notice how their openness changes</div>
                            </div>
                        </div>
                        <div class="mt-4 text-sm opacity-90 italic">
                            Most physicians start with narrow parameters based on assumptions. Professional challenging helps them see possibilities they'd otherwise miss. This skill alone can increase your placement rate by 20-30%.
                        </div>
                    </div>
                </div>
            `;
      }

      function renderCompensation() {
        return `
                <div class="space-y-6">
                    <!-- Overview -->
                    <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl p-8 shadow-2xl">
                        <h2 class="text-3xl font-bold mb-3 flex items-center">
                            <span class="mr-3">√∞≈∏‚Äô¬∞</span>
                            Compensation Management Excellence
                        </h2>
                        <p class="text-lg opacity-95 mb-4">
                            Professional compensation discussions build trust and uncover flexibility. Misalignment isn't failure - it's an opportunity for creative problem-solving.
                        </p>
                        <div class="bg-white dark:bg-gray-800 bg-opacity-20 rounded-lg p-4">
                            <div class="text-xl font-bold mb-2">Golden Rule:</div>
                            <div class="text-lg">
                                Discover current compensation BEFORE presenting opportunities. Use MGMA data to anchor expectations realistically.
                            </div>
                        </div>
                    </div>

                    <!-- MGMA Data Table -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äú≈†</span>
                            MGMA 2025 Compensation Data by Specialty
                        </h3>
                        <div class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                            Use this data to anchor expectations and demonstrate market knowledge. Always quote ranges before specific numbers.
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm border">
                                <thead class="bg-gradient-to-r from-green-500 to-emerald-600 text-white">
                                    <tr>
                                        <th class="text-left p-3 font-bold">Specialty</th>
                                        <th class="text-center p-3 font-bold">25th Percentile</th>
                                        <th class="text-center p-3 font-bold">Median (50th)</th>
                                        <th class="text-center p-3 font-bold">75th Percentile</th>
                                        <th class="text-center p-3 font-bold">Full Range</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y">
                                    ${Object.entries(specialtyData)
                                      .map(
                                        ([key, spec]) => `
                                        <tr class="hover:bg-gray-50 dark:bg-gray-900">
                                            <td class="p-3 font-semibold">${spec.icon} ${spec.name}</td>
                                            <td class="p-3 text-center">${spec.compensation.percentile25}</td>
                                            <td class="p-3 text-center font-bold text-green-700">${spec.compensation.percentile50}</td>
                                            <td class="p-3 text-center">${spec.compensation.percentile75}</td>
                                            <td class="p-3 text-center text-sm text-gray-600 dark:text-gray-400">${spec.compensation.range}</td>
                                        </tr>
                                    `
                                      )
                                      .join("")}
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-4 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                            <div class="font-bold text-blue-900 mb-2">√∞≈∏‚Äô¬° Using MGMA Data Effectively:</div>
                            <div class="text-sm text-blue-800 space-y-1">
                                <div>√¢‚Ç¨¬¢ Always present as ranges, not specific numbers</div>
                                <div>√¢‚Ç¨¬¢ Acknowledge variations by geography and setting</div>
                                <div>√¢‚Ç¨¬¢ Rural/underserved areas typically 10-15% above median</div>
                                <div>√¢‚Ç¨¬¢ Academic positions typically 10-20% below median</div>
                                <div>√¢‚Ç¨¬¢ Partnership/ownership can add 20-30% to base</div>
                            </div>
                        </div>
                    </div>

                    <!-- Discovery Scripts -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏‚Äù¬ç</span>
                            Compensation Discovery Scripts
                        </h3>
                        <div class="space-y-4">
                            <div class="border-l-4 border-green-500 bg-green-50 rounded-lg p-4">
                              <div class="font-bold text-green-900 mb-2">1. Current Compensation Structure</div>
                                <div class="text-sm italic text-green-800 mb-3">
                                    "Help me understand your current compensation structure - base salary, bonuses, benefits, partnership potential. Give me the complete picture so I can make sure any opportunities I present are a step forward for you..."
                                </div>
                                <div class="text-xs text-green-700 bg-green-100 p-2 rounded">
                                    <strong>Why this works:</strong> Gets total comp, not just base. Shows you're looking out for their interests. Reveals what components matter most.
                                </div>
                            </div>

                            <div class="border-l-4 border-blue-500 bg-blue-50 rounded-lg p-4">
                                <div class="font-bold text-blue-900 mb-2">2. Future Compensation Expectations</div>
                                <div class="text-sm italic text-blue-800 mb-3">
                                    "When you think about your next position, what compensation package would make a move worthwhile? What's driving those expectations?"
                                </div>
                                <div class="text-xs text-blue-700 bg-blue-100 p-2 rounded">
                                    <strong>Why this works:</strong> Uncovers financial motivations beyond numbers - loan repayment, retirement goals, lifestyle needs. Reveals flexibility.
                                </div>
                            </div>

                            <div class="border-l-4 border-purple-500 bg-purple-50 rounded-lg p-4">
                                <div class="font-bold text-purple-900 mb-2">3. Financial Goals & Priorities</div>
                                <div class="text-sm italic text-purple-800 mb-3">
                                    "Tell me about your financial goals for the next 5 years and how your next position fits into that plan..."
                                </div>
                                <div class="text-xs text-purple-700 bg-purple-100 p-2 rounded">
                                    <strong>Why this works:</strong> Uncovers whether compensation is about student loans, retirement, kids' college, lifestyle upgrade - helps with creative structuring.
                                </div>
                            </div>

                            <div class="border-l-4 border-orange-500 bg-orange-50 rounded-lg p-4">
                                <div class="font-bold text-orange-900 mb-2">4. Components Prioritization</div>
                                <div class="text-sm italic text-orange-800 mb-3">
                                    "When you think about compensation, what matters most to you - the base salary, the total package, the growth potential, the lifestyle it enables? Help me understand your priorities..."
                                </div>
                                <div class="text-xs text-orange-700 bg-orange-100 p-2 rounded">
                                    <strong>Why this works:</strong> Reveals tradeoff willingness and what levers you have to work with in negotiation.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Handling Misalignment -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√¢≈°‚Äì√Ø¬∏¬è</span>
                            Professional Misalignment Handling
                        </h3>
                        <div class="mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded">
                            <div class="font-bold text-yellow-900 mb-2">Core Principle:</div>
                            <div class="text-sm text-yellow-800">
                                Compensation misalignment doesn't automatically disqualify an opportunity. Address it honestly while exploring flexibility on other factors. Many successful placements started with comp misalignment.
                            </div>
                        </div>

                        <div class="space-y-4">
                            <div class="bg-red-50 border-l-4 border-red-500 rounded-lg p-4">
                                <div class="font-bold text-red-900 mb-2">Scenario: Expectation Above Offer</div>
                                <div class="text-sm text-red-800 mb-2">
                                    <strong>Physician expects:</strong> $400k base<br>
                                    <strong>Opportunity offers:</strong> $350k base
                                </div>
                                <div class="bg-white dark:bg-gray-700 border border-red-200 dark:border-red-700 rounded p-3 space-y-2">
                                    <div class="text-sm italic text-red-900 dark:text-red-100">
                                        "I want to be transparent with you. The opportunity I'm thinking of offers $350k base, which is below your $400k target. Before we dismiss it, help me understand what's most important to you - is it the base number, the total package, the growth potential, or the lifestyle factors?"
                                    </div>
                                    <div class="text-sm italic text-red-900 dark:text-red-100">
                                        "If this position could offer [other priority like amazing work-life balance / partnership track / minimal call] that addresses what's driving your search, how much flexibility might you have on the base?"
                                    </div>
                                    <div class="text-sm italic text-red-900 dark:text-red-100">
                                        "The base is $350k, but the total package with bonuses typically reaches $380-390k. When we add in the quality of life factors you mentioned wanting, does that change how you view this?"
                                    </div>
                                </div>
                            </div>

                            <div class="bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4">
                                <div class="font-bold text-blue-900 mb-2">Scenario: Expectation Below Market</div>
                                <div class="text-sm text-blue-800 mb-2">
                                    <strong>Physician expects:</strong> $250k<br>
                                    <strong>Market range:</strong> $300-350k
                                </div>
                                <div class="bg-white dark:bg-gray-700 border border-blue-200 dark:border-blue-700 rounded p-3 space-y-2">
                                    <div class="text-sm italic text-blue-900 dark:text-blue-100">
                                        "Based on what you've shared about your experience and the current market for ${
                                          specialtyData[state.activeSpecialty]
                                            .name
                                        }, opportunities in your area typically range from [market range]. You mentioned $250k - can you help me understand how you arrived at that number?"
                                    </div>
                                    <div class="text-sm italic text-blue-900 dark:text-blue-100">
                                        "I appreciate your flexibility on compensation, but I want to make sure you're paid fairly. The market data shows [range]. What if we could find something that gives you everything else you want AND compensates you at market rate?"
                                    </div>
                                </div>
                                <div class="text-xs text-blue-700 bg-blue-100 p-2 rounded mt-2">
                                    <strong>Why address this:</strong> Protects physician from underpayment, builds trust, demonstrates market knowledge, prevents buyer's remorse later.
                                </div>
                            </div>

                            <div class="bg-green-50 border-l-4 border-green-500 rounded-lg p-4">
                                <div class="font-bold text-green-900 mb-2">Scenario: Focus on Total Package vs. Base</div>
                                <div class="bg-white dark:bg-gray-700 border border-green-200 dark:border-green-700 rounded p-3 space-y-2">
                                    <div class="text-sm italic text-green-900 dark:text-green-100">
                                        "You mentioned $400k. Help me clarify - is that base salary only, or total compensation including bonuses, benefits, and other incentives?"
                                    </div>
                                    <div class="text-sm italic text-green-900 dark:text-green-100">
                                        "What components of compensation matter most to you? Base salary, production bonuses, signing bonus, student loan repayment, retirement contributions, CME allowance?"
                                    </div>
                                    <div class="text-sm italic text-green-900 dark:text-green-100">
                                        "Sometimes a lower base with strong incentives ends up being more lucrative. Would you be open to structures where your total comp could exceed your target even if the base is lower?"
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Creative Structuring Options -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center">
                            <span class="mr-2">√∞≈∏≈Ω¬®</span>
                            Creative Compensation Structuring
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            ${[
                              {
                                title: "Signing Bonuses",
                                description: "One-time payments to bridge gap",
                                examples: [
                                  "$20-50k to offset base difference",
                                  "Loan repayment as signing bonus",
                                  "Moving/relocation covered separately",
                                ],
                                script:
                                  '"While the base is $X, they offer a $25k signing bonus and $15k relocation, which effectively brings your first year to $X..."',
                              },
                              {
                                title: "Production Bonuses",
                                description: "Incentive-based upside potential",
                                examples: [
                                  "RVU-based quarterly bonuses",
                                  "Patient volume incentives",
                                  "Quality metric bonuses",
                                ],
                                script:
                                  '"The base is $X, but physicians here average $40-60k in annual production bonuses, bringing typical total comp to $X..."',
                              },
                              {
                                title: "Loan Repayment",
                                description:
                                  "Tax-advantaged student loan support",
                                examples: [
                                  "NHSC/HRSA programs in underserved",
                                  "$50-200k total repayment",
                                  "Annual installments tax-free",
                                ],
                                script:
                                  '"This qualifies for $150k in federal loan repayment over 3 years. When you factor that in alongside the $X base, it\'s equivalent to $X..."',
                              },
                              {
                                title: "Partnership Track",
                                description:
                                  "Ownership equity and profit-sharing",
                                examples: [
                                  "2-3 year partnership timeline",
                                  "Profit distribution adds 20-40%",
                                  "Equity value long-term",
                                ],
                                script:
                                  '"While you start at $X as an associate, partners here earn $X-X with profit sharing and equity. The partnership track is 2 years..."',
                              },
                              {
                                title: "Benefit Enhancements",
                                description: "Non-cash value additions",
                                examples: [
                                  "Generous CME ($5-10k)",
                                  "Paid malpractice tail coverage",
                                  "Enhanced retirement match",
                                ],
                                script:
                                  '"Beyond the $X base, they cover 100% of malpractice including tail, $8k CME, and 8% 401k match - that\'s $30k+ in additional value..."',
                              },
                              {
                                title: "Quality of Life Trade",
                                description:
                                  "Compensation vs. lifestyle balance",
                                examples: [
                                  "Lower base, better schedule",
                                  "Reduced call for less pay",
                                  "More PTO time off",
                                ],
                                script:
                                  '"You mentioned work-life balance is your top priority. This offers $X base - $20k less than your target - but only 1 weekend per month and no evening clinic. What\'s that quality of life worth to you?"',
                              },
                            ]
                              .map(
                                (option) => `
                                <div class="border rounded-lg overflow-hidden">
                                    <div class="bg-gradient-to-r from-green-100 to-emerald-100 p-3 border-b">
                                        <div class="font-bold text-green-900">${
                                          option.title
                                        }</div>
                                        <div class="text-xs text-green-700">${
                                          option.description
                                        }</div>
                                    </div>
                                    <div class="p-3 space-y-2">
                                        <div class="text-xs text-gray-700 dark:text-gray-300 space-y-1">
                                            ${option.examples
                                              .map((ex) => `<div>√¢‚Ç¨¬¢ ${ex}</div>`)
                                              .join("")}
                                        </div>
                                        <div class="bg-green-50 border border-green-200 rounded p-2 text-xs italic text-green-800">
                                            ${option.script}
                                        </div>
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>

                    <!-- Red Flags to Avoid -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                        <h3 class="font-bold text-xl mb-4 flex items-center text-red-700">
                            <span class="mr-2">√∞≈∏≈°¬´</span>
                            Compensation Discussion Mistakes
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                <div class="font-bold text-red-900 mb-3">√¢¬ù≈í What NOT to Do:</div>
                                <div class="text-sm text-red-800 space-y-2">
                                    <div>√¢‚Ç¨¬¢ Present opportunity before knowing current comp</div>
                                    <div>√¢‚Ç¨¬¢ Lead with compensation when it's not their top priority</div>
                                    <div>√¢‚Ç¨¬¢ Quote specific numbers without ranges/context</div>
                                    <div>√¢‚Ç¨¬¢ Dismiss opportunity immediately if comp doesn't align</div>
                                    <div>√¢‚Ç¨¬¢ Argue about what someone "should" make</div>
                                    <div>√¢‚Ç¨¬¢ Make promises you can't keep about negotiation</div>
                                    <div>√¢‚Ç¨¬¢ Share other candidates' comp expectations</div>
                                </div>
                            </div>
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <div class="font-bold text-green-900 mb-3">√¢≈ì‚Ä¶ Best Practices:</div>
                                <div class="text-sm text-green-800 space-y-2">
                                    <div>√¢‚Ç¨¬¢ Discover current comp before any presentations</div>
                                    <div>√¢‚Ç¨¬¢ Use MGMA data to anchor expectations</div>
                                    <div>√¢‚Ç¨¬¢ Focus on total package, not just base</div>
                                    <div>√¢‚Ç¨¬¢ Explore misalignment before dismissing</div>
                                    <div>√¢‚Ç¨¬¢ Be transparent about market realities</div>
                                    <div>√¢‚Ç¨¬¢ Understand motivations behind numbers</div>
                                    <div>√¢‚Ç¨¬¢ Present creative structures when appropriate</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Professional Compensation Tips -->
                    <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl p-6">
                        <h3 class="font-bold text-xl mb-4">√∞≈∏‚Äô¬° Professional Compensation Management Tips</h3>
                        <div class="grid md:grid-cols-2 gap-4 text-sm">
                            <div class="space-y-2">
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Always quote total compensation, not just base salary</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Use MGMA data to demonstrate market knowledge</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Explore financial motivations beyond the number</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Present ranges before specific numbers</span>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Misalignment isn't automatic disqualification</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Benefits and lifestyle can offset lower base</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Be transparent about what's realistic</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">√¢≈ì‚Äú</span>
                                    <span>Use creative structuring to bridge gaps</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      // ============= MAIN RENDER =============

      function render() {
        // Save scroll positions before render
        saveScrollPositions();

        const app = document.getElementById("app");

        let content = "";

        if (state.callMode === "live") {
          content = renderLiveCall();
        } else {
          switch (state.activeTab) {
            case "prep":
              content = renderPrep();
              break;
            case "specialty":
              content = renderSpecialtyGuide();
              break;
            case "questions":
              content = renderQuestionQuality();
              break;
            case "challenging":
              content = renderProfessionalChallenging();
              break;
            case "compensation":
              content = renderCompensation();
              break;
            default:
              content = renderPrep();
          }
        }

        app.innerHTML = `
                <!-- Header -->
                <div class="gradient-header text-white shadow-2xl">
                    <div class="max-w-7xl mx-auto p-8">
                        <div class="flex items-center justify-between">
                            <div>
                                <h1 class="text-4xl font-bold mb-2 flex items-center">
                                    <span class="mr-3">√∞≈∏≈Ω¬Ø</span>
                                    Pacific Companies
                                </h1>
                                <p class="text-xl opacity-95">Permanent Physician Recruiting √¢‚Ç¨¬¢ V3.4 Excellence Framework</p>
                            </div>
                            <div class="flex items-center space-x-6">
                                <div class="text-right">
                                    <div class="text-sm opacity-90 mb-1">Your Standard</div>
                                    <div class="text-3xl font-bold">80/20/Excellence</div>
                                </div>
                                <!-- Dark Mode Toggle -->
                                <button
                                    onclick="toggleDarkMode()"
                                    class="dark-mode-toggle p-3 bg-white dark:bg-gray-800 bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all"
                                    title="${
                                      state.darkMode
                                        ? "Switch to Light Mode"
                                        : "Switch to Dark Mode"
                                    }"
                                >
                                    <span class="text-2xl">${
                                      state.darkMode ? "√¢Àú‚Ç¨√Ø¬∏¬è" : "√∞≈∏≈í‚Ñ¢"
                                    }</span>
                                </button>
                                <!-- Logout Button -->
                                <button
                                    id="logoutBtn"
                                    class="p-3 bg-white dark:bg-gray-800 bg-opacity-20 hover:bg-opacity-30 hover:bg-red-500 hover:bg-opacity-40 rounded-lg transition-all flex items-center space-x-2"
                                    title="Logout"
                                >
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                                    </svg>
                                    <span class="text-sm font-medium">Logout</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Tabs -->
                ${
                  !state.callMode
                    ? `
                    <div class="bg-white dark:bg-gray-800 dark:bg-gray-800 shadow-lg sticky top-0 z-10 border-b-2 border-gray-200 dark:border-gray-700 dark:border-gray-700">
                        <div class="max-w-7xl mx-auto">
                            <div class="flex overflow-x-auto">
                                ${[
                                  {
                                    id: "prep",
                                    label: "Pre-Call Prep",
                                    icon: "√∞≈∏≈Ω¬Ø",
                                  },
                                  {
                                    id: "specialty",
                                    label: "Specialty Guide",
                                    icon: "√∞≈∏‚Äú≈°",
                                  },
                                  {
                                    id: "questions",
                                    label: "Question Quality",
                                    icon: "√¢¬ù‚Äú",
                                  },
                                  {
                                    id: "challenging",
                                    label: "Professional Challenging",
                                    icon: "√∞≈∏‚Äô¬™",
                                  },
                                  {
                                    id: "compensation",
                                    label: "Compensation",
                                    icon: "√∞≈∏‚Äô¬∞",
                                  },
                                ]
                                  .map(
                                    (tab) => `
                                    <button
                                        onclick="state.activeTab = '${
                                          tab.id
                                        }'; render();"
                                        class="flex-shrink-0 flex items-center space-x-2 px-6 py-4 font-bold transition-all ${
                                          state.activeTab === tab.id
                                            ? "bg-gradient-to-r from-blue-500 to-indigo-600 text-white border-b-4 border-blue-700"
                                            : "text-gray-600 dark:text-gray-400 dark:text-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border-b-4 border-transparent"
                                        }"
                                    >
                                        <span class="text-xl">${tab.icon}</span>
                                        <span>${tab.label}</span>
                                    </button>
                                `
                                  )
                                  .join("")}
                            </div>
                        </div>
                    </div>
                `
                    : ""
                }

                <!-- Main Content -->
                <div class="max-w-7xl mx-auto p-6">
                    ${content}
                </div>

                <!-- Footer -->
                <div class="bg-gradient-to-r from-gray-800 to-gray-900 text-white mt-12 py-8 shadow-2xl">
                    <div class="max-w-7xl mx-auto px-6">
                        <div class="text-center mb-4">
                            <p class="text-2xl font-bold mb-2">Excellence Through Discovery</p>
                            <p class="text-lg opacity-90">80% Open-Ended Questions √¢‚Ç¨¬¢ Deep Pain Discovery √¢‚Ç¨¬¢ Sequence Compliance</p>
                        </div>
                        <div class="text-center text-sm opacity-75 border-t border-gray-700 pt-4">
                            <p>All candidate data must be documented in Bullhorn √¢‚Ç¨¬¢ MGMA 2025 compensation data</p>
                            <p class="mt-1">√Ç¬© Pacific Companies √¢‚Ç¨¬¢ V3.4 Framework</p>
                        </div>
                    </div>
                </div>
            `;

        // Restore scroll positions after render
        restoreScrollPositions();
      }

      // Initialize the application
      async function initializeApp() {
        try {
          // Initialize dark mode preference
          initializeDarkMode();

          // Load all specialty data
          await loadSpecialties();

          // Verify we have at least one specialty
          if (Object.keys(specialtyData).length === 0) {
            document.getElementById("app").innerHTML = `
                        <div class="flex items-center justify-center min-h-screen">
                            <div class="text-center">
                                <p class="text-2xl text-red-600 mb-4">√¢≈°¬†√Ø¬∏¬è Error Loading Specialties</p>
                                <p class="text-gray-600 dark:text-gray-400 dark:text-gray-400">Please ensure specialty JSON files are in the specialties/ folder</p>
                            </div>
                        </div>
                    `;
            return;
          }

          // Initial render with loaded data
          console.log("√¢≈ì‚Äú Application initialized successfully");
          render();
        } catch (error) {
          console.error("Failed to initialize application:", error);
          document.getElementById("app").innerHTML = `
                    <div class="flex items-center justify-center min-h-screen">
                        <div class="text-center">
                            <p class="text-2xl text-red-600 mb-4">√¢≈°¬†√Ø¬∏¬è Error Initializing Application</p>
                            <p class="text-gray-600 dark:text-gray-400 dark:text-gray-400">${error.message}</p>
                        </div>
                    </div>
                `;
        }
      }

      // Start the app when DOM is ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initializeApp);
      } else {
        initializeApp();
      }
    </script>
  </body>
</html>
